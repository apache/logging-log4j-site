<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!--
 Licensed to the Apache Software Foundation (ASF) under one or more
 contributor license agreements. See the NOTICE file distributed with
 this work for additional information regarding copyright ownership.
 The ASF licenses this file to You under the Apache License, Version 2.0
 (the "License"); you may not use this file except in compliance with
 the License. You may obtain a copy of the License at

         http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.
-->
<!--
 | (Unfortunately) copied from the Fluido skin to allow the footer to be centered.
-->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>CPD Results</title>
    <link rel="stylesheet" href="./css/apache-maven-fluido.min.css" />
    <link rel="stylesheet" href="./css/site.css" />
    <link rel="stylesheet" href="./css/print.css" media="print" />

        
    <script type="text/javascript" src="./js/apache-maven-fluido.min.js"></script>

    
                    <meta name="Date-Revision-yyyymmdd" content="20121111" />
                <meta http-equiv="Content-Language" content="en" />
                </head>
        <body class="topBarDisabled">
            
                
                    
    
        <div class="container-fluid">
        <div id="banner">
        <div class="pull-left">
                                                                                        <a href="../index.html" id="bannerLeft">
                                                                                                                                                        <img src="../images/ls-logo.jpg"  alt="Logging Services"/>
                            </a>
                                </div>
        <div class="pull-right">                    <div id="bannerRight">
                                                                                                                                                        <img src="../images/logo.jpg" />
                            </div>
            </div>
        <div class="clear"><hr/></div>
    </div>

    <div id="breadcrumbs">
        <ul class="breadcrumb">
                        
                        
                            <li id="publishDate">Last Published: 2012-11-11</li>
                        <li class="divider">|</li> <li id="projectVersion">Version: 2.0-beta3</li>
                                    
                        
                        
            
                                                        
    <li class="pull-right">                        <a href="../index.html" title="Log4j">Log4j</a>
    </li>

                <li class="divider pull-right">|</li>
            
    <li class="pull-right">                        <a href="../../../" title="Logging Services">Logging Services</a>
    </li>

                <li class="divider pull-right">|</li>
            
    <li class="pull-right">                        <a href="http://www.apache.org/" class="externalLink" title="Apache">Apache</a>
    </li>

                <li class="divider pull-right">|</li>
            
    <li class="pull-right">                        <a href="http://wiki.apache.org/logging" class="externalLink" title="Logging Wiki">Logging Wiki</a>
    </li>

                                </ul>
    </div>

        <div class="row-fluid">
        <div id="leftColumn" class="span2">
            <div class="well sidebar-nav">
                            
                        
                                                                                    <h3>Apache Log4jâ„¢ 2</h3>
                                                    <ul>
                        <li class="none">
                                                <a href="../index.html" title="About">About</a>
                    </li>
                  <li class="none">
                                                <a href="../download.html" title="Download">Download</a>
                    </li>
                  <li class="none">
                                                <a href="../build.html" title="Build and Install">Build and Install</a>
                    </li>
                  <li class="none">
                                                <a href="../changelog.html" title="Changelog">Changelog</a>
                    </li>
              </ul>
                                                                <h3>Manual</h3>
                                                    <ul>
                        <li class="none">
                                                <a href="../manual/index.html" title="Introduction">Introduction</a>
                    </li>
                  <li class="none">
                                                <a href="../manual/architecture.html" title="Architecture">Architecture</a>
                    </li>
                  <li class="none">
                                                <a href="../manual/migration.html" title="Log4j 1.x Migration">Log4j 1.x Migration</a>
                    </li>
                                                                                                                                                                                                                                                                                                                                                                                                              <li class="collapsed">
                                                <a href="../manual/api.html" title="API">API</a>
                                </li>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                  <li class="collapsed">
                                                <a href="../manual/configuration.html" title="Configuration">Configuration</a>
                                </li>
                                                                                                                                                                                                                                                  <li class="collapsed">
                                                <a href="../manual/plugins.html" title="Plugins">Plugins</a>
                                </li>
                                                                                                                                                                                                                                                                                                                                                                                                              <li class="collapsed">
                                                <a href="../manual/lookups.html" title="Lookups">Lookups</a>
                                </li>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          <li class="collapsed">
                                                <a href="../manual/appenders.html" title="Appenders">Appenders</a>
                                </li>
                                                                                                                                                                                                                                                                                                                                                                                                              <li class="collapsed">
                                                <a href="../manual/layouts.html" title="Layouts">Layouts</a>
                                </li>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              <li class="collapsed">
                                                <a href="../manual/filters.html" title="Filters">Filters</a>
                                </li>
                  <li class="none">
                                                <a href="../manual/jmx.html" title="JMX">JMX</a>
                    </li>
                  <li class="none">
                                                <a href="../manual/logsep.html" title="Logging Separation">Logging Separation</a>
                    </li>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              <li class="collapsed">
                                                <a href="../manual/extending.html" title="Extending Log4j">Extending Log4j</a>
                                </li>
              </ul>
                                                                <h3>Components</h3>
                                                    <ul>
                        <li class="none">
                                                <a href="../log4j-api/index.html" title="API">API</a>
                    </li>
                  <li class="none">
                                                <a href="../log4j-core/index.html" title="Impl">Impl</a>
                    </li>
                  <li class="none">
                                                <a href="../log4j12-api/index.html" title="Log4J 1.2 API">Log4J 1.2 API</a>
                    </li>
                  <li class="none">
                                                <a href="../log4j-jcl/index.html" title="Commons Logging Bridge">Commons Logging Bridge</a>
                    </li>
                  <li class="none">
                                                <a href="../log4j-slf4j-impl/index.html" title="SLF4J Binding">SLF4J Binding</a>
                    </li>
                  <li class="none">
                                                <a href="../log4j-flume-ng/index.html" title="Apache Flume">Apache Flume</a>
                    </li>
                  <li class="none">
                                                <a href="../log4j-web/index.html" title="Log4j Web">Log4j Web</a>
                    </li>
              </ul>
                                                                                                        <h3>Core Documentation</h3>
                                                    <ul>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <li class="collapsed">
                                                <a href="project-info.html" title="Project Information">Project Information</a>
                                </li>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          <li class="expanded">
                                                <a href="project-reports.html" title="Project Reports">Project Reports</a>
                                        <ul>
                              <li class="none">
                                                <a href="surefire-report.html" title="Surefire Report">Surefire Report</a>
                    </li>
                      <li class="none">
                                                <a href="rat-report.html" title="RAT Report">RAT Report</a>
                    </li>
                      <li class="none">
                                                <a href="checkstyle.html" title="Checkstyle">Checkstyle</a>
                    </li>
                      <li class="none">
                                                <a href="apidocs/index.html" title="JavaDocs">JavaDocs</a>
                    </li>
                      <li class="none">
                                                <a href="findbugs.html" title="FindBugs Report">FindBugs Report</a>
                    </li>
                      <li class="none">
                                                <a href="xref/index.html" title="Source Xref">Source Xref</a>
                    </li>
                      <li class="none">
                                                <a href="pmd.html" title="PMD Report">PMD Report</a>
                    </li>
                      <li class="none">
                        <strong>CPD Report</strong>
                </li>
                    </ul>
            </li>
              </ul>
                                        
                        
                            
                <hr class="divider" />

                <div id="poweredBy">
                                            <div class="clear"></div>
                                            <div class="clear"></div>
                                            <div class="clear"></div>
                                                <a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy">
            <img class="poweredBy" alt="Built by Maven" src="./images/logos/maven-feather.png" />
        </a>
                            </div>
            </div>
        </div>
    
    <div id="bodyColumn"  class="span10" >
                                
            <div class="section"><h2>CPD Results<a name="CPD_Results"></a></h2><p>The following document contains the results of PMD's  <a class="externalLink" href="http://pmd.sourceforge.net/cpd.html">CPD</a> 4.3.</p></div><div class="section"><h2>Duplications<a name="Duplications"></a></h2><table border="0" class="table table-striped"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>org/apache/logging/log4j/core/config/JSONConfiguration.java</td><td><a href="./xref/org/apache/logging/log4j/core/config/JSONConfiguration.html#84">84</a></td></tr><tr class="a"><td>org/apache/logging/log4j/core/config/XMLConfiguration.java</td><td><a href="./xref/org/apache/logging/log4j/core/config/XMLConfiguration.html#104">104</a></td></tr><tr class="b"><td colspan='2'><div><pre>            for (Map.Entry&lt;String, String&gt; entry : rootNode.getAttributes().entrySet()) {
                if (&quot;status&quot;.equalsIgnoreCase(entry.getKey())) {
                    status = Level.toLevel(getSubst().replace(entry.getValue()), null);
                    if (status == null) {
                        status = Level.ERROR;
                        messages.add(&quot;Invalid status specified: &quot; + entry.getValue() + &quot;. Defaulting to ERROR&quot;);
                    }
                } else if (&quot;dest&quot;.equalsIgnoreCase(entry.getKey())) {
                    String dest = entry.getValue();
                    if (dest != null) {
                        if (dest.equalsIgnoreCase(&quot;err&quot;)) {
                            stream = System.err;
                        } else {
                            try {
                                File destFile = FileUtils.fileFromURI(new URI(dest));
                                stream = new PrintStream(new FileOutputStream(destFile));
                            } catch (URISyntaxException use) {
                                System.err.println(&quot;Unable to write to &quot; + dest + &quot;. Writing to stdout&quot;);
                            }
                        }
                    }
                } else if (&quot;verbose&quot;.equalsIgnoreCase(entry.getKey())) {
                    verbose = Boolean.parseBoolean(getSubst().replace(entry.getValue()));
                } else if (&quot;packages&quot;.equalsIgnoreCase(entry.getKey())) {</pre></div></td></tr></table><table border="0" class="table table-striped"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>org/apache/logging/log4j/core/filter/MapFilter.java</td><td><a href="./xref/org/apache/logging/log4j/core/filter/MapFilter.html#123">123</a></td></tr><tr class="a"><td>org/apache/logging/log4j/core/filter/StructuredDataFilter.java</td><td><a href="./xref/org/apache/logging/log4j/core/filter/StructuredDataFilter.html#107">107</a></td></tr><tr class="b"><td>org/apache/logging/log4j/core/filter/ThreadContextMapFilter.java</td><td><a href="./xref/org/apache/logging/log4j/core/filter/ThreadContextMapFilter.html#116">116</a></td></tr><tr class="a"><td colspan='2'><div><pre>            LOGGER.error(&quot;keys and values must be specified for the MapFilter&quot;);
            return null;
        }
        Map&lt;String, List&lt;String&gt;&gt; map = new HashMap&lt;String, List&lt;String&gt;&gt;();
        for (KeyValuePair pair : pairs) {
            String key = pair.getKey();
            if (key == null) {
                LOGGER.error(&quot;A null key is not valid in MapFilter&quot;);
                continue;
            }
            String value = pair.getValue();
            if (value == null) {
                LOGGER.error(&quot;A null value for key &quot; + key + &quot; is not allowed in MapFilter&quot;);
                continue;
            }
            List&lt;String&gt; list = map.get(pair.getKey());
            if (list != null) {
                list.add(value);
            } else {
                list = new ArrayList&lt;String&gt;();
                list.add(value);
                map.put(pair.getKey(), list);
            }
        }
        if (map.size() == 0) {
            LOGGER.error(&quot;MapFilter is not configured with any valid key value pairs&quot;);</pre></div></td></tr></table><table border="0" class="table table-striped"><tr class="b"><th>File</th><th>Line</th></tr><tr class="a"><td>org/apache/logging/log4j/core/pattern/ExtendedThrowablePatternConverter.java</td><td><a href="./xref/org/apache/logging/log4j/core/pattern/ExtendedThrowablePatternConverter.html#73">73</a></td></tr><tr class="b"><td>org/apache/logging/log4j/core/pattern/RootThrowablePatternConverter.java</td><td><a href="./xref/org/apache/logging/log4j/core/pattern/RootThrowablePatternConverter.html#74">74</a></td></tr><tr class="a"><td colspan='2'><div><pre>    public static ExtendedThrowablePatternConverter newInstance(final String[] options) {
        String type = null;
        String[] array = options;
        if (options != null &amp;&amp; options.length == 1 &amp;&amp; options[0].length() &gt; 0) {
            String[] opts = options[0].split(&quot;,&quot;, 2);
            String first = opts[0].trim();
            String filter;
            Scanner scanner = new Scanner(first);
            if (first.equalsIgnoreCase(FULL) || first.equalsIgnoreCase(SHORT) || scanner.hasNextInt()) {
                type = first;
                filter = opts[1].trim();
            } else {
                filter = options[0].trim();
            }
            array = new String[] {type, filter};
        }

        return new ExtendedThrowablePatternConverter(array);</pre></div></td></tr></table><table border="0" class="table table-striped"><tr class="b"><th>File</th><th>Line</th></tr><tr class="a"><td>org/apache/logging/log4j/core/pattern/ExtendedThrowablePatternConverter.java</td><td><a href="./xref/org/apache/logging/log4j/core/pattern/ExtendedThrowablePatternConverter.html#49">49</a></td></tr><tr class="b"><td>org/apache/logging/log4j/core/pattern/RootThrowablePatternConverter.java</td><td><a href="./xref/org/apache/logging/log4j/core/pattern/RootThrowablePatternConverter.html#50">50</a></td></tr><tr class="a"><td colspan='2'><div><pre>        super(&quot;ExtendedThrowable&quot;, &quot;throwable&quot;, options);
        List&lt;String&gt; tempPackages = null;
        if (options != null &amp;&amp; options.length &gt; 1) {
            if (options[1].startsWith(FILTERS) &amp;&amp; options[1].endsWith(&quot;)&quot;)) {
                String filterStr = options[1].substring(FILTERS.length(), options[1].length() - 1);
                String[] array = filterStr.split(&quot;,&quot;);
                if (array.length &gt; 0) {
                    tempPackages = new ArrayList&lt;String&gt;(array.length);
                    for (String token : array) {
                        tempPackages.add(token.trim());
                    }
                }
            }
        }
        packages = tempPackages;
    }

    /**
     * Gets an instance of the class.
     *
     * @param options pattern options, may be null.  If first element is &quot;short&quot;,
     *                only the first line of the throwable will be formatted.
     * @return instance of class.
     */
    public static ExtendedThrowablePatternConverter newInstance(final String[] options) {</pre></div></td></tr></table><table border="0" class="table table-striped"><tr class="b"><th>File</th><th>Line</th></tr><tr class="a"><td>org/apache/logging/log4j/core/layout/HTMLLayout.java</td><td><a href="./xref/org/apache/logging/log4j/core/layout/HTMLLayout.html#192">192</a></td></tr><tr class="b"><td>org/apache/logging/log4j/core/layout/XMLLayout.java</td><td><a href="./xref/org/apache/logging/log4j/core/layout/XMLLayout.html#217">217</a></td></tr><tr class="a"><td colspan='2'><div><pre>    private void appendThrowableAsHTML(Throwable throwable, StringBuilder sbuf) {
        StringWriter sw = new StringWriter();
        PrintWriter pw = new PrintWriter(sw);
        try {
            throwable.printStackTrace(pw);
        } catch (RuntimeException ex) {
            // Ignore the exception.
        }
        pw.flush();
        LineNumberReader reader = new LineNumberReader(new StringReader(sw.toString()));
        ArrayList&lt;String&gt; lines = new ArrayList&lt;String&gt;();
        try {
          String line = reader.readLine();
          while (line != null) {
            lines.add(line);
            line = reader.readLine();
          }
        } catch (IOException ex) {
            if (ex instanceof InterruptedIOException) {
                Thread.currentThread().interrupt();
            }
            lines.add(ex.toString());
        }</pre></div></td></tr></table><table border="0" class="table table-striped"><tr class="b"><th>File</th><th>Line</th></tr><tr class="a"><td>org/apache/logging/log4j/core/appender/rolling/helper/GZCompressAction.java</td><td><a href="./xref/org/apache/logging/log4j/core/appender/rolling/helper/GZCompressAction.html#57">57</a></td></tr><tr class="b"><td>org/apache/logging/log4j/core/appender/rolling/helper/ZipCompressAction.java</td><td><a href="./xref/org/apache/logging/log4j/core/appender/rolling/helper/ZipCompressAction.html#58">58</a></td></tr><tr class="a"><td colspan='2'><div><pre>    public GZCompressAction(final File source, final File destination, final boolean deleteSource) {
        if (source == null) {
            throw new NullPointerException(&quot;source&quot;);
        }

        if (destination == null) {
            throw new NullPointerException(&quot;destination&quot;);
        }

        this.source = source;
        this.destination = destination;
        this.deleteSource = deleteSource;
    }

    /**
     * Compress.
     *
     * @return true if successfully compressed.
     * @throws IOException on IO exception.
     */
    @Override
    public boolean execute() throws IOException {
        return execute(source, destination, deleteSource);
    }

    /**
     * Compress a file.
     *
     * @param source       file to compress, may not be null.
     * @param destination  compressed file, may not be null.
     * @param deleteSource if true, attempt to delete file on completion.  Failure to delete
     *                     does not cause an exception to be thrown or affect return value.
     * @return true if source file compressed.
     * @throws IOException on IO exception.
     */
    public static boolean execute(final File source, final File destination, final boolean deleteSource)
        throws IOException {
        if (source.exists()) {
            FileInputStream fis = new FileInputStream(source);
            FileOutputStream fos = new FileOutputStream(destination);</pre></div></td></tr></table><table border="0" class="table table-striped"><tr class="b"><th>File</th><th>Line</th></tr><tr class="a"><td>org/apache/logging/log4j/core/pattern/ExtendedThrowablePatternConverter.java</td><td><a href="./xref/org/apache/logging/log4j/core/pattern/ExtendedThrowablePatternConverter.html#105">105</a></td></tr><tr class="b"><td>org/apache/logging/log4j/core/pattern/RootThrowablePatternConverter.java</td><td><a href="./xref/org/apache/logging/log4j/core/pattern/RootThrowablePatternConverter.html#106">106</a></td></tr><tr class="a"><td colspan='2'><div><pre>            String trace = t.getExtendedStackTrace(packages);
            int len = toAppendTo.length();
            if (len &gt; 0 &amp;&amp; !Character.isWhitespace(toAppendTo.charAt(len - 1))) {
                toAppendTo.append(&quot; &quot;);
            }
            if (lines &gt; 0) {
                StringBuilder sb = new StringBuilder();
                String[] array = trace.split(&quot;\n&quot;);
                for (int i = 0; i &lt; lines; ++i) {
                    sb.append(array[i]).append(&quot;\n&quot;);
                }
                toAppendTo.append(sb.toString());

            } else {
                toAppendTo.append(trace);
            }
        }
    }
}</pre></div></td></tr></table><table border="0" class="table table-striped"><tr class="b"><th>File</th><th>Line</th></tr><tr class="a"><td>org/apache/logging/log4j/core/filter/BurstFilter.java</td><td><a href="./xref/org/apache/logging/log4j/core/filter/BurstFilter.html#88">88</a></td></tr><tr class="b"><td>org/apache/logging/log4j/core/filter/DynamicThresholdFilter.java</td><td><a href="./xref/org/apache/logging/log4j/core/filter/DynamicThresholdFilter.html#57">57</a></td></tr><tr class="a"><td>org/apache/logging/log4j/core/filter/ThresholdFilter.java</td><td><a href="./xref/org/apache/logging/log4j/core/filter/ThresholdFilter.html#46">46</a></td></tr><tr class="b"><td colspan='2'><div><pre>    }

    @Override
    public Result filter(Logger logger, Level level, Marker marker, String msg, Object[] params) {
        return filter(level);
    }

    @Override
    public Result filter(Logger logger, Level level, Marker marker, Object msg, Throwable t) {
        return filter(level);
    }

    @Override
    public Result filter(Logger logger, Level level, Marker marker, Message msg, Throwable t) {
        return filter(level);
    }

    @Override
    public Result filter(LogEvent event) {
        return filter(event.getLevel());
    }

    /**
     * Decide if we're going to log &lt;code&gt;event&lt;/code&gt; based on whether the
     * maximum burst of log statements has been exceeded.
     *
     * @param level The log level.
     * @return The onMatch value if the filter passes, onMismatch otherwise.
     */
    private Result filter(Level level) {</pre></div></td></tr></table><table border="0" class="table table-striped"><tr class="a"><th>File</th><th>Line</th></tr><tr class="b"><td>org/apache/logging/log4j/core/config/JSONConfiguration.java</td><td><a href="./xref/org/apache/logging/log4j/core/config/JSONConfiguration.html#125">125</a></td></tr><tr class="a"><td>org/apache/logging/log4j/core/config/XMLConfiguration.java</td><td><a href="./xref/org/apache/logging/log4j/core/config/XMLConfiguration.html#148">148</a></td></tr><tr class="b"><td colspan='2'><div><pre>                StatusListener listener = statusIter.next();
                if (listener instanceof StatusConsoleListener) {
                    found = true;
                    ((StatusConsoleListener) listener).setLevel(status);
                    if (!verbose) {
                        ((StatusConsoleListener) listener).setFilters(VERBOSE_CLASSES);
                    }
                }
            }
            if (!found &amp;&amp; status != Level.OFF) {
                StatusConsoleListener listener = new StatusConsoleListener(status, stream);
                if (!verbose) {
                    listener.setFilters(VERBOSE_CLASSES);
                }
                ((StatusLogger) LOGGER).registerListener(listener);
                for (String msg : messages) {
                    LOGGER.error(msg);
                }
            }</pre></div></td></tr></table></div>
            </div>
        </div>
    
    <hr/>

    <footer>
                <div class="container-fluid">
                <div class="row footer">Copyright &copy; 1999-2012 <a href="http://www.apache.org">Apache Software Foundation</a>. All Rights Reserved.</br />
            Apache Logging, Apache Log4j, Log4j, Apache, the Apache feather logo, and the Apache Logging project logo are trademarks of The Apache Software Foundation.</div>
        </div>
    </footer>
</body>
</html>