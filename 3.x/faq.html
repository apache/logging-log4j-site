<!DOCTYPE html>
<!--
 | Generated by Apache Maven Doxia Site Renderer 1.11.1 from target/generated-sources/site/asciidoc/faq.adoc at 2023-12-19
 | Rendered using Apache Maven Fluido Skin 1.8
-->
<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="generator" content="Apache Maven Doxia Site Renderer 1.11.1" />
    <title>Log4j &#x2013; </title>
    <link rel="stylesheet" href="./css/apache-maven-fluido-1.8.min.css" />
    <link rel="stylesheet" href="./css/site.css" />
    <link rel="stylesheet" href="./css/print.css" media="print" />
    <script src="./js/apache-maven-fluido-1.8.min.js"></script>
  </head>
  <body class="topBarDisabled">
    <div class="container-fluid">
      <header>
        <div id="banner">
          <div class="pull-left"><a href="http://logging.apache.org" id="bannerLeft"><img src="images/ls-logo.jpg"  alt=""/></a></div>
          <div class="pull-right"><a href="http://logging.apache.org/log4j/3.x" id="bannerRight"><img src="images/logo.png"  alt=""/></a></div>
          <div class="clear"><hr/></div>
        </div>

        <div id="breadcrumbs">
          <ul class="breadcrumb">
        <li id="publishDate">Last Published: 2023-12-19<span class="divider">|</span>
</li>
          <li id="projectVersion">Version: 3.0.0-beta1</li>
      <li class="pull-right"><span class="divider">|</span>
<a href="https://github.com/apache/logging-log4j2" class="externalLink" title="GitHub">GitHub</a></li>
      <li class="pull-right"><span class="divider">|</span>
<a href="https://analysis.apache.org/dashboard/index/org.apache.logging.log4j:log4j" class="externalLink" title="Sonar">Sonar</a></li>
      <li class="pull-right"><span class="divider">|</span>
<a href="../../" title="Logging Services">Logging Services</a></li>
      <li class="pull-right"><span class="divider">|</span>
<a href="https://www.apache.org/" class="externalLink" title="Apache">Apache</a></li>
      <li class="pull-right"><a href="https://cwiki.apache.org/confluence/display/LOGGING/Log4j" class="externalLink" title="Logging Wiki">Logging Wiki</a></li>
          </ul>
        </div>
      </header>
      <div class="row-fluid">
        <header id="leftColumn" class="span2">
          <nav class="well sidebar-nav">
  <ul class="nav nav-list">
   <li class="nav-header"><img class="imageLink" src="img/glyphicons/home.png" alt="Apache Log4j™ 3.x" border="0"/> Apache Log4j™ 3.x</li>
    <li><a href="index.html" title="About"><span class="none"></span>About</a></li>
    <li><a href="download.html" title="Download"><span class="none"></span>Download</a></li>
    <li><a href="javadoc.html" title="Javadoc"><span class="none"></span>Javadoc</a></li>
    <li><a href="maven-artifacts.html" title="Maven, Ivy, Gradle Artifacts"><span class="icon-chevron-right"></span>Maven, Ivy, Gradle Artifacts</a></li>
    <li><a href="runtime-dependencies.html" title="Runtime Dependencies"><span class="none"></span>Runtime Dependencies</a></li>
    <li><a href="release-notes.html" title="Release Notes"><span class="none"></span>Release Notes</a></li>
    <li class="active"><a href="#"><span class="none"></span>FAQ</a></li>
    <li><a href="performance.html" title="Performance"><span class="icon-chevron-right"></span>Performance</a></li>
    <li><a href="articles.html" title="Articles and Tutorials"><span class="none"></span>Articles and Tutorials</a></li>
    <li><a href="security.html" title="Security"><span class="none"></span>Security</a></li>
    <li><a href="support.html" title="Support"><span class="none"></span>Support</a></li>
    <li><a href="thanks.html" title="Thanks"><span class="none"></span>Thanks</a></li>
   <li class="nav-header"><img class="imageLink" src="img/glyphicons/pencil.png" alt="For Contributors" border="0"/> For Contributors</li>
    <li><a href="guidelines.html" title="Guidelines"><span class="none"></span>Guidelines</a></li>
    <li><a href="javastyle.html" title="Style Guide"><span class="none"></span>Style Guide</a></li>
   <li class="nav-header"><img class="imageLink" src="img/glyphicons/book.png" alt="Manual" border="0"/> Manual</li>
    <li><a href="manual/index.html" title="Introduction"><span class="none"></span>Introduction</a></li>
    <li><a href="manual/architecture.html" title="Architecture"><span class="none"></span>Architecture</a></li>
    <li><a href="manual/compatibility.html" title="Log4j 1.x Compatibility"><span class="none"></span>Log4j 1.x Compatibility</a></li>
    <li><a href="manual/migration.html" title="Log4j 1.x Migration"><span class="none"></span>Log4j 1.x Migration</a></li>
    <li><a href="manual/api.html" title="Java API"><span class="icon-chevron-right"></span>Java API</a></li>
    <li><a href="manual/scala-api.html" title="Scala API"><span class="none"></span>Scala API</a></li>
    <li><a href="manual/configuration.html" title="Configuration"><span class="icon-chevron-right"></span>Configuration</a></li>
    <li><a href="manual/usage.html" title="Usage"><span class="icon-chevron-right"></span>Usage</a></li>
    <li><a href="manual/lookups.html" title="Lookups"><span class="icon-chevron-right"></span>Lookups</a></li>
    <li><a href="manual/appenders.html" title="Appenders"><span class="icon-chevron-right"></span>Appenders</a></li>
    <li><a href="manual/layouts.html" title="Layouts"><span class="icon-chevron-right"></span>Layouts</a></li>
    <li><a href="manual/filters.html" title="Filters"><span class="icon-chevron-right"></span>Filters</a></li>
    <li><a href="manual/async.html" title="Async Loggers"><span class="icon-chevron-right"></span>Async Loggers</a></li>
    <li><a href="manual/garbagefree.html" title="Garbage-free Logging"><span class="icon-chevron-right"></span>Garbage-free Logging</a></li>
    <li><a href="manual/jmx.html" title="JMX"><span class="none"></span>JMX</a></li>
    <li><a href="manual/logsep.html" title="Logging Separation"><span class="none"></span>Logging Separation</a></li>
    <li><a href="manual/extending.html" title="Extending Log4j"><span class="icon-chevron-right"></span>Extending Log4j</a></li>
    <li><a href="manual/plugins.html" title="Plugins"><span class="icon-chevron-right"></span>Plugins</a></li>
    <li><a href="manual/customconfig.html" title="Programmatic Log4j Configuration"><span class="icon-chevron-right"></span>Programmatic Log4j Configuration</a></li>
    <li><a href="manual/customloglevels.html" title="Custom Log Levels"><span class="icon-chevron-right"></span>Custom Log Levels</a></li>
   <li class="nav-header"><img class="imageLink" src="img/glyphicons/tag.png" alt="Related Projects" border="0"/> Related Projects</li>
    <li><a href="http://logging.apache.org/log4j/scala/index.html" class="externalLink" title="Log4j-Scala"><span class="none"></span>Log4j-Scala</a></li>
   <li class="nav-header"><img class="imageLink" src="img/glyphicons/link.png" alt="Older Releases" border="0"/> Older Releases</li>
    <li><a href="http://logging.apache.org/log4j/1.2/" class="externalLink" title="Log4j 1.2 - End of Life"><span class="none"></span>Log4j 1.2 - End of Life</a></li>
    <li><a href="http://logging.apache.org/log4j/log4j-2.3/" class="externalLink" title="Log4j 2.3 - Java 6"><span class="none"></span>Log4j 2.3 - Java 6</a></li>
    <li><a href="http://logging.apache.org/log4j/log4j-2.12.1/" class="externalLink" title="Log4j 2.12.1 - Java 7"><span class="none"></span>Log4j 2.12.1 - Java 7</a></li>
    <li><a href="http://logging.apache.org/log4j/2.x/" class="externalLink" title="Log4j 2.x - Latest release for Java 8"><span class="none"></span>Log4j 2.x - Latest release for Java 8</a></li>
   <li class="nav-header"><img class="imageLink" src="img/glyphicons/layers.png" alt="Internal Components" border="0"/> Internal Components</li>
    <li><a href="log4j-api.html" title="API"><span class="none"></span>API</a></li>
    <li><a href="log4j-core.html" title="Implementation"><span class="none"></span>Implementation</a></li>
    <li><a href="log4j-jcl.html" title="Commons Logging Bridge"><span class="none"></span>Commons Logging Bridge</a></li>
    <li><a href="log4j-1.2-api.html" title="Log4j 1.2 API"><span class="none"></span>Log4j 1.2 API</a></li>
    <li><a href="log4j-slf4j-impl.html" title="SLF4J Binding"><span class="none"></span>SLF4J Binding</a></li>
    <li><a href="log4j-jul.html" title="JUL Adapter"><span class="none"></span>JUL Adapter</a></li>
    <li><a href="log4j-jpl.html" title="JDK Platform Logger"><span class="none"></span>JDK Platform Logger</a></li>
    <li><a href="log4j-to-slf4j.html" title="Log4j 2 to SLF4J Adapter"><span class="none"></span>Log4j 2 to SLF4J Adapter</a></li>
    <li><a href="log4j-jdbc-dbcp2.html" title="JDBC Appender"><span class="none"></span>JDBC Appender</a></li>
    <li><a href="log4j-flume-ng.html" title="Apache Flume Appender"><span class="none"></span>Apache Flume Appender</a></li>
    <li><a href="log4j-appserver.html" title="Application Server Integration"><span class="none"></span>Application Server Integration</a></li>
    <li><a href="log4j-mongodb4.html" title="MongoDB 4 appender"><span class="none"></span>MongoDB 4 appender</a></li>
    <li><a href="log4j-iostreams.html" title="IO Streams"><span class="none"></span>IO Streams</a></li>
    <li><a href="log4j-docker.html" title="Docker Support"><span class="none"></span>Docker Support</a></li>
    <li><a href="log4j-kubernetes.html" title="Kubernetes Support"><span class="none"></span>Kubernetes Support</a></li>
    <li><a href="log4j-spring-cloud-config-client.html" title="Spring Cloud Config Client"><span class="none"></span>Spring Cloud Config Client</a></li>
    <li><a href="log4j-transform" title="Log4j Transformation Tools"><span class="none"></span>Log4j Transformation Tools</a></li>
   <li class="nav-header"><img class="imageLink" src="img/glyphicons/link.png" alt="External Components" border="0"/> External Components</li>
    <li><a href="log4j/jakarta" title="Log4j Jakarta EE"><span class="none"></span>Log4j Jakarta EE</a></li>
    <li><a href="log4j/jmx-gui" title="Log4j JMX GUI"><span class="none"></span>Log4j JMX GUI</a></li>
    <li><a href="log4j/tools" title="Log4j Tools"><span class="none"></span>Log4j Tools</a></li>
    <li><a href="log4j/transform" title="Log4j Transformation Tools"><span class="none"></span>Log4j Transformation Tools</a></li>
   <li class="nav-header"><img class="imageLink" src="img/glyphicons/info.png" alt="Project Information" border="0"/> Project Information</li>
    <li><a href="team.html" title="Project Team"><span class="none"></span>Project Team</a></li>
    <li><a href="https://www.apache.org/licenses/LICENSE-2.0" class="externalLink" title="Project License"><span class="none"></span>Project License</a></li>
    <li><a href="https://github.com/apache/logging-log4j2/tree/main" class="externalLink" title="Source Repository"><span class="none"></span>Source Repository</a></li>
   <li class="nav-header"><img class="imageLink" src="img/glyphicons/layers.png" alt="Project Reports" border="0"/> Project Reports</li>
    <li><a href="rat-report.html" title="RAT Report"><span class="none"></span>RAT Report</a></li>
  </ul>
          </nav>
          <div class="well sidebar-nav">
            <hr />
            <div id="poweredBy">
              <div class="clear"></div>
              <div class="clear"></div>
              <div class="clear"></div>
<a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy"><img class="builtBy" alt="Built by Maven" src="./images/logos/maven-feather.png" /></a>
            </div>
          </div>
        </header>
        <main id="bodyColumn"  class="span10" >
<h1>Frequently Asked Questions</h1>
<div id="preamble">
<div class="sectionbody">
<link rel="stylesheet" type="text/css" href="css/tables.css">
<hr/>
</div>
</div>
<div class="sect1">
<h2 id="missing_core">I&#8217;m seeing this error "Unable to locate a logging implementation, using SimpleLogger". What is wrong?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>You have the log4j-api-2.x jar file in your classpath but you still need
to add the log4j-core-2.x jar to the classpath. (Also, it looks like you
are using an old version of Log4j 2. You may want to upgrade.)</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="which_jars">Which JAR files do I need?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>You need at least the log4j-api-2.x and the log4j-core-2.x jar files.</p>
</div>
<div class="paragraph">
<p>The other jars are necessary if your application calls the API of
another logging framework and you want to route logging calls to the
Log4j 2 implementation.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/whichjar-2.x.png" alt="Diagram showing which JARs correspond to which systems"/></span></p>
</div>
<div class="paragraph">
<p>You can use the log4j-to-slf4j adapter jar when your application calls
the Log4j 2 API and you want to route logging calls to a SLF4J
implementation.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/whichjar-slf4j-2.x.png" alt="Diagram showing the dependency flow to use Log4j 2 API with SLF4J"/></span></p>
</div>
<div class="paragraph">
<p>Some of the Log4j components have features with optional dependencies.
The component page will have more detail. For example, the
<a href="log4j-core/index.html">log4j-core component page</a> has an outline of
which log4j-core features have external dependencies.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="exclusions">How do I exclude conflicting dependencies?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>There are several scenarios where you may end up with conflicting
dependencies, especially transitively included ones. The following table
shows for each Log4j dependency on the left (implicit groupId of
<code>org.apache.logging.log4j</code>), the following dependencies on the right can
be safely excluded (given in the format <code>groupId:artifactId</code>).</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 25%;"/>
<col style="width: 25%;"/>
<col style="width: 25%;"/>
<col style="width: 25%;"/>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Log4j Dependency</th>
<th class="tableblock halign-left valign-top" colspan="3">Dependencies to Exclude</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>log4j-1.2-api</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>log4j:log4j</code></p></td>
<td class="tableblock halign-left valign-top" colspan="2"><p class="tableblock"><code>org.slf4j:log4j-over-slf4j</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>log4j-core</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>log4j:log4j</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ch.qos.logback:logback-core</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>org.apache.logging.log4j:log4j-to-slf4j</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>log4j-jcl</code></p></td>
<td class="tableblock halign-left valign-top" colspan="3"><p class="tableblock"><code>org.slf4j:jcl-over-slf4j</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>log4j-jul</code></p></td>
<td class="tableblock halign-left valign-top" colspan="3"><p class="tableblock"><code>org.slf4j:jul-to-slf4j</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>log4j-slf4j-impl</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>org.apache.logging.log4j:log4j-to-slf4j</code></p></td>
<td class="tableblock halign-left valign-top" colspan="2"><p class="tableblock"><code>ch.qos.logback:logback-core</code></p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Using Apache Maven, dependencies can be globally excluded in your
project like so:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;dependencies&gt;
  &lt;dependency&gt;
    &lt;groupId&gt;log4j&lt;/groupId&gt;
    &lt;artifactId&gt;log4j&lt;/artifactId&gt;
    &lt;version&gt;1.2.17&lt;/version&gt;
    &lt;scope&gt;provided&lt;/scope&gt;
  &lt;/dependency&gt;
&lt;/dependencies&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Dependencies can be explicitly excluded for specific dependencies as
well. For example, to use a project with Log4j 2 instead of Log4j 1.x:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;dependencies&gt;
  &lt;dependency&gt;
    &lt;groupId&gt;com.example&lt;/groupId&gt;
    &lt;artifactId&gt;example-project&lt;/artifactId&gt;
    &lt;version&gt;1.0&lt;/version&gt;
    &lt;exclusions&gt;
      &lt;exclusion&gt;
        &lt;groupId&gt;log4j&lt;/groupId&gt;
        &lt;artifactId&gt;log4j&lt;/artifactId&gt;
      &lt;/exclusion&gt;
      &lt;exclusion&gt;
        &lt;groupId&gt;org.slf4j&lt;/groupId&gt;
        &lt;artifactId&gt;slf4j-log4j12&lt;/artifactId&gt;
      &lt;/exclusion&gt;
    &lt;/exclusions&gt;
  &lt;/dependency&gt;
  &lt;dependency&gt;
    &lt;groupId&gt;org.apache.logging.log4j&lt;/groupId&gt;
    &lt;artifactId&gt;log4j-core&lt;/artifactId&gt;
    &lt;version&gt;{Log4jReleaseVersion}&lt;/version&gt;
  &lt;/dependency&gt;
  &lt;dependency&gt;
    &lt;groupId&gt;org.apache.logging.log4j&lt;/groupId&gt;
    &lt;artifactId&gt;log4j-slf4j-impl&lt;/artifactId&gt;
    &lt;version&gt;{Log4jReleaseVersion}&lt;/version&gt;
  &lt;/dependency&gt;
  &lt;dependency&gt;
    &lt;groupId&gt;org.apache.logging.log4j&lt;/groupId&gt;
    &lt;artifactId&gt;log4j-1.2-api&lt;/artifactId&gt;
    &lt;version&gt;{Log4jReleaseVersion}&lt;/version&gt;
  &lt;/dependency&gt;
&lt;/dependencies&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Dependencies can be globally excluded in Gradle like so:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-gradle" data-lang="gradle">configurations {
  all*.exclude group: 'log4j', module: 'log4j'
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The equivalent Gradle config for the above Maven exclusion would look
like:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-gradle" data-lang="gradle">dependencies {
  compile('com.example:example-project:1.0') {
    exclude group: 'log4j', module: 'log4j'
    exclude group: 'org.slf4j', module: 'slf4j-log4j12'
  }
  compile('org.apache.logging.log4j:log4j-core:{Log4jReleaseVersion}')
  compile('org.apache.logging.log4j:log4j-slf4j-impl:{Log4jReleaseVersion}')
  compile('org.apache.logging.log4j:log4j-1.2-api:{Log4jReleaseVersion}')
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="config_location">How do I specify the configuration file location?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>By default, Log4j looks for a configuration file named <strong>log4j2.xml</strong> (not
log4j.xml) in the classpath.</p>
</div>
<div class="paragraph">
<p>You can also specify the full path of the configuration file with this
system property: <code>-Dlog4j.configurationFile=path/to/log4j2.xml</code></p>
</div>
<div class="paragraph">
<p>That property can also be included in a classpath resource file named
<code>log4j2.component.properties</code>.</p>
</div>
<div class="paragraph">
<p>Web applications can specify the Log4j configuration file location with
a servlet context parameter. See
<a href="http://logging.apache.org/log4j/jakarta">Log4j Jakarta EE</a> page for details.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="config_from_code">How do I configure log4j2 in code without a configuration file?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Starting with version 2.4, Log4j 2 provides an
<a href="manual/customconfig.html">API for programmatic configuration</a> The
new
<a href="log4j-core/apidocs/org/apache/logging/log4j/core/config/builder/api/ConfigurationBuilder.html"><code>ConfigurationBuilder</code>
API</a> allows you to create Configurations in code by constructing
component definitions without requiring you to know about the internals
of actual configuration objects like Loggers and Appenders.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="reconfig_from_code">How do I reconfigure log4j2 in code with a specific configuration file?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>See the below example. Be aware that this LoggerContext class is not
part of the public API so your code may break with any minor release.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">// import org.apache.logging.log4j.core.LoggerContext;

LoggerContext context = (org.apache.logging.log4j.core.LoggerContext) LogManager.getContext(false);
File file = new File("path/to/a/different/log4j2.xml");

// this will force a reconfiguration
context.setConfigLocation(file.toURI());</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="shutdown">How do I shut down log4j2 in code?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Normally there is no need to do this manually. Each <code>LoggerContext</code>
registers a shutdown hook that takes care of releasing resources when
the JVM exits (unless system property <code>log4j.shutdownHookEnabled</code> is set
to <code>false</code>). See the <a href="https://logging.apache.org/log4j/jakarta">Log4j Jakarta EE</a>
project page on details of how this works for web applications.</p>
</div>
<div class="paragraph">
<p>However, if you need to manually shut down Log4j, you can do so as in
the below example. Note that there is an optional parameter for
specifying which <code>LoggerContext</code> to shut down.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">import org.apache.logging.log4j.LogManager;

// ...

LogManager.shutdown();</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="config_sep_appender_level">How do I send log messages with different levels to different</h2>
<div class="sectionbody">
<div class="paragraph">
<p>appenders? You don’t need to declare separate loggers to achieve this.
You can set the logging level on the <code>AppenderRef</code> element.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;Configuration status="WARN"&gt;
  &lt;Appenders&gt;
    &lt;File name="file" fileName="app.log"&gt;
      &lt;PatternLayout&gt;
        &lt;Pattern&gt;%d %p %c{1.} [%t] %m %ex%n&lt;/Pattern&gt;
      &lt;/PatternLayout&gt;
    &lt;/File&gt;
    &lt;Console name="STDOUT" target="SYSTEM_OUT"&gt;
      &lt;PatternLayout pattern="%m%n"/&gt;
    &lt;/Console&gt;
  &lt;/Appenders&gt;
  &lt;Loggers&gt;
    &lt;Root level="trace"&gt;
      &lt;AppenderRef ref="file" level="DEBUG"/&gt;
      &lt;AppenderRef ref="STDOUT" level="INFO"/&gt;
    &lt;/Root&gt;
  &lt;/Loggers&gt;
&lt;/Configuration&gt;</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="troubleshooting">How do I debug my configuration?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>First, make sure you have <a href="#which_jars">the right jar files</a> on your
classpath. You need at least log4j-api and log4j-core.</p>
</div>
<div class="paragraph">
<p>Next, check the name of your configuration file. By default, log4j2 will
look for a configuration file named <code>log4j2.xml</code> on the classpath. Note
the ``2'' in the file name! (See the
<a href="manual/configuration.html#AutomaticConfiguration">configuration
manual page</a> for more details.)</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">From log4j-2.9 onward</dt>
<dd>
<p>From log4j-2.9 onward, log4j2 will print all internal logging to the
console if system property <code>log4j2.debug</code> is either defined empty or its value
equals to <code>true</code> (ignoring case).</p>
</dd>
<dt class="hdlist1">Prior to log4j-2.9</dt>
<dd>
<p>Prior to log4j-2.9, there are two places where internal logging can be
controlled:</p>
<div class="paragraph">
<p>If the configuration file is found correctly, log4j2 internal status
logging can be controlled by setting <code>&lt;Configuration status="trace"&gt;</code> in
the configuration file. This will display detailed log4j2-internal log
statements on the console about what happens during the configuration
process. This may be useful to trouble-shoot configuration issues. By
default the status logger level is WARN, so you only see notifications
when there is a problem.</p>
</div>
<div class="paragraph">
<p>If the configuration file is not found correctly, you can still enable
log4j2 internal status logging by setting system property
<code>-Dorg.apache.logging.log4j.simplelog.StatusLogger.level=TRACE</code>.</p>
</div>
</dd>
</dl>
</div>
</div>
</div>
<div class="sect1">
<h2 id="separate_log_files">How do I dynamically write to separate log files?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Look at the
<a href="http://logging.apache.org/log4j/2.x/manual/appenders.html#RoutingAppender">RoutingAppender</a>.
You can define multiple routes in the configuration, and put values in
the <code>ThreadContext</code> map that determine which log file subsequent events
in this thread get logged to.</p>
</div>
<div class="paragraph">
<p>You can use the <code>ThreadContext</code> map value to determine the log file
name.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;Routing name="Routing"&gt;
  &lt;Routes pattern="$${ctx:ROUTINGKEY}"&gt;

    &lt;!-- This route is chosen if ThreadContext has value 'special' for key ROUTINGKEY. --&gt;
    &lt;Route key="special"&gt;
      &lt;RollingFile name="Rolling-${ctx:ROUTINGKEY}" fileName="logs/special-${ctx:ROUTINGKEY}.log"
    filePattern="./logs/${date:yyyy-MM}/${ctx:ROUTINGKEY}-special-%d{yyyy-MM-dd}-%i.log.gz"&gt;
    &lt;PatternLayout&gt;
      &lt;pattern&gt;%d{ISO8601} [%t] %p %c{3} - %m%n&lt;/pattern&gt;
    &lt;/PatternLayout&gt;
    &lt;Policies&gt;
      &lt;TimeBasedTriggeringPolicy interval="6" modulate="true" /&gt;
          &lt;SizeBasedTriggeringPolicy size="10 MB" /&gt;
    &lt;/Policies&gt;
      &lt;/RollingFile&gt;
    &lt;/Route&gt;

    &lt;!-- This route is chosen if ThreadContext has no value for key ROUTINGKEY. --&gt;
    &lt;Route key="$${ctx:ROUTINGKEY}"&gt;
      &lt;RollingFile name="Rolling-default" fileName="logs/default.log"
    filePattern="./logs/${date:yyyy-MM}/default-%d{yyyy-MM-dd}-%i.log.gz"&gt;
        &lt;PatternLayout&gt;
      &lt;pattern&gt;%d{ISO8601} [%t] %p %c{3} - %m%n&lt;/pattern&gt;
        &lt;/PatternLayout&gt;
        &lt;Policies&gt;
          &lt;TimeBasedTriggeringPolicy interval="6" modulate="true" /&gt;
          &lt;SizeBasedTriggeringPolicy size="10 MB" /&gt;
        &lt;/Policies&gt;
      &lt;/RollingFile&gt;
    &lt;/Route&gt;

    &lt;!-- This route is chosen if ThreadContext has a value for ROUTINGKEY
         (other than the value 'special' which had its own route above).
         The value dynamically determines the name of the log file. --&gt;
    &lt;Route&gt;
      &lt;RollingFile name="Rolling-${ctx:ROUTINGKEY}" fileName="logs/other-${ctx:ROUTINGKEY}.log"
    filePattern="./logs/${date:yyyy-MM}/${ctx:ROUTINGKEY}-other-%d{yyyy-MM-dd}-%i.log.gz"&gt;
    &lt;PatternLayout&gt;
      &lt;pattern&gt;%d{ISO8601} [%t] %p %c{3} - %m%n&lt;/pattern&gt;
    &lt;/PatternLayout&gt;
    &lt;Policies&gt;
      &lt;TimeBasedTriggeringPolicy interval="6" modulate="true" /&gt;
      &lt;SizeBasedTriggeringPolicy size="10 MB" /&gt;
    &lt;/Policies&gt;
      &lt;/RollingFile&gt;
    &lt;/Route&gt;
  &lt;/Routes&gt;
&lt;/Routing&gt;</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="reconfig_level_from_code">How do I set a logger’s level programmatically?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>You can set a logger’s level with the class
<a href="log4j-core/apidocs/org/apache/logging/log4j/core/config/Configurator.html"><code>Configurator</code></a>
from Log4j Core. Be aware that the <code>Configurator</code> class is not part of
the public API.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">import org.apache.logging.log4j.core.config.Configurator;

// ...

Configurator.setLevel("com.example.Foo", Level.DEBUG);

// You can also set the root logger:
Configurator.setRootLevel(Level.DEBUG);</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="retention">How do I set my log archive retention policy? How do I delete old log archives?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The <code>DefaultRolloverStrategy</code> of the Rolling File appender (and Rolling
Random Access File appender) supports a
<a href="manual/appenders.html#CustomDeleteOnRollover">Delete</a> element.</p>
</div>
<div class="paragraph">
<p>Starting at a specified base directory, you can delete all files for
which some condition holds true, for example all files that match a
given file name pattern and are older than some number of days. More
complex conditions are possible, and if the built-in conditions are not
sufficient, users can provide custom conditions by creating
<a href="manual/appenders.html#DeletePathCondition">plugin conditions</a> or by
writing a <a href="manual/appenders.html#ScriptCondition">script condition</a>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="api-tradeoffs">What are the trade-offs of using the Log4j 2 API versus the SLF4J API?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The Log4j 2 API and SLF4J have a lot in common. They both share the
objective of cleanly separating the logging API from the implementation.
We believe that the Log4j 2 API can help make your application more
performant while offering more functionality and more flexibility.</p>
</div>
<div class="paragraph">
<p>There may be a concern that using the Log4j 2 API will tightly couple
your application to Log4j 2. This is not the case: applications coded to
the Log4j 2 API always have the option to use any SLF4J-compliant
library as their logging implementation with the log4j-to-slf4j adapter.
See the <a href="#which_jars_log4j-to-slf4j">which jars</a> FAQ entry for
details.</p>
</div>
<div class="paragraph">
<p>There are several advantages to using the Log4j 2 API:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>SLF4J forces your application to log Strings. The Log4j 2 API supports
logging any CharSequence if you want to log text, but also supports
logging any Object as is. It is the responsibility of the logging
implementation to handle this object, and we consider it a design
mistake to limit applications to logging Strings.</p>
</li>
<li>
<p>The Log4j 2 API offers support for logging
<a href="manual/messages.html">Message objects</a>. Messages allow support for
interesting and complex constructs to be passed through the logging
system and be efficiently manipulated. Users are free to create their
own Message types and write custom Layouts, Filters and Lookups to
manipulate them.</p>
</li>
<li>
<p>The Log4j 2 API has support for Java 8
<a href="manual/api.html#LambdaSupport">lambda expressions</a>.</p>
</li>
<li>
<p>The Log4j 2 API has better support for
<a href="manual/garbagefree.html">garbage-free logging</a>: it avoids creating
vararg arrays and avoids creating Strings when logging CharSequence
objects.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="gc-free-slf4j">Is Log4j 2 still garbage-free when I use the SLF4J API?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Yes, the log4j-slf4j-impl binding (together with log4j-core) implements
the <code>org.slf4j.Logger</code> methods to be GC-free. However, bear in mind that
there are some limitations:</p>
</div>
<div class="paragraph">
<p>The SLF4J API only offers up to two parameters for a parameterized
message. More than that uses varargs which creates a temporary object
for the parameter array. The Log4j 2.6 API has methods for up to ten
unrolled parameters.</p>
</div>
<div class="paragraph">
<p>Another consideration is that the SLF4J API forces your application to
log Strings. Log4j 2 API lets you log any java.lang.CharSequence, and
even any Objects. Log4j can log any Object that implements
<code>java.lang.CharSequence</code> or
<code>org.apache.logging.log4j.util.StringBuilderFormattable</code> without
creating garbage.</p>
</div>
<div class="paragraph">
<p>The
<a href="https://www.slf4j.org/api/org/slf4j/spi/LocationAwareLogger.html#log-org.slf4j.Marker-java.lang.String-int-java.lang.String-java.lang.Object:A-java.lang.Throwable-"><code>org.slf4j.spi.LocationAwareLogger::log</code></a>
method is not yet implemented in a garbage-free manner in the
log4j-slf4j-impl binding. It creates a new message object for each call.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="gc-free-domain-object">How do I log my domain object without creating garbage?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>One option is to let the domain object implement java.lang.CharSequence.
However, for many domain objects it may not be trivial to implement this
without allocating temporary objects.</p>
</div>
<div class="paragraph">
<p>An alternative is to implement the
<code>org.apache.logging.log4j.util.StringBuilderFormattable</code> interface. If
an object is logged that implements this interface, its <code>formatTo</code>
method is called instead of <code>toString()</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">package org.apache.logging.log4j.util;
public interface StringBuilderFormattable {
    /**
     * Writes a text representation of this object into the specified {@code StringBuilder},
     * ideally without allocating temporary objects.
     *
     * @param buffer the StringBuilder to write into
     */
     void formatTo(StringBuilder buffer);
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="logger-wrapper">How do I create a custom logger wrapper that shows the correct class, method and line number?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Log4j remembers the fully qualified class name (FQCN) of the logger and
uses this to walk the stack trace for every log event when configured to
print location. (Be aware that logging with location is slow and may
impact the performance of your application.)</p>
</div>
<div class="paragraph">
<p>The problem with custom logger wrappers is that they have a different
FQCN than the actual logger, so Log4j can’t find the place where your
custom logger was called.</p>
</div>
<div class="paragraph">
<p>The solution is to provide the correct FQCN. The easiest way to do this
is to let Log4j generate the logger wrapper for you. Log4j comes with a
Logger wrapper generator tool. This tool was originally meant to support
custom log levels and is documented
<a href="https://logging.apache.org/log4j/2.x/manual/customloglevels.html#CustomLoggers">here</a>.</p>
</div>
<div class="paragraph">
<p>The generated logger code will take care of the FQCN.</p>
</div>
</div>
</div>
        </main>
      </div>
    </div>
    <hr/>
    <footer>
      <div class="container-fluid">
        <div class="row-fluid">
<p align="center">Copyright &copy; 1999-2023 <a class="external" href="http://www.apache.org">The Apache Software Foundation</a>. All Rights Reserved.<br>
      Apache Logging, Apache Log4j, Log4j, Apache, the Apache feather logo, and the Apache Logging project logo are trademarks of The Apache Software Foundation.</p>
        </div>
      </div>
    </footer>
  </body>
</html>
