<!DOCTYPE html>
<!--
 | Generated by Apache Maven Doxia Site Renderer 1.11.1 from target/generated-sources/site/markdown/log4j-kubernetes.md.vm at 2023-06-15
 | Rendered using Apache Maven Fluido Skin 1.8
-->
<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="generator" content="Apache Maven Doxia Site Renderer 1.11.1" />
    <title>Log4j &#x2013; Log4j Kubernetes Support</title>
    <link rel="stylesheet" href="./css/apache-maven-fluido-1.8.min.css" />
    <link rel="stylesheet" href="./css/site.css" />
    <link rel="stylesheet" href="./css/print.css" media="print" />
    <script src="./js/apache-maven-fluido-1.8.min.js"></script>
  </head>
  <body class="topBarDisabled">
    <div class="container-fluid">
      <header>
        <div id="banner">
          <div class="pull-left"><a href="http://logging.apache.org" id="bannerLeft"><img src="images/ls-logo.jpg"  alt=""/></a></div>
          <div class="pull-right"><a href="http://logging.apache.org/log4j/3.x" id="bannerRight"><img src="images/logo.png"  alt=""/></a></div>
          <div class="clear"><hr/></div>
        </div>

        <div id="breadcrumbs">
          <ul class="breadcrumb">
        <li id="publishDate">Last Published: 2023-06-15<span class="divider">|</span>
</li>
          <li id="projectVersion">Version: 3.0.0-alpha1</li>
      <li class="pull-right"><span class="divider">|</span>
<a href="https://github.com/apache/logging-log4j2" class="externalLink" title="GitHub">GitHub</a></li>
      <li class="pull-right"><span class="divider">|</span>
<a href="https://analysis.apache.org/dashboard/index/org.apache.logging.log4j:log4j" class="externalLink" title="Sonar">Sonar</a></li>
      <li class="pull-right"><span class="divider">|</span>
<a href="../../" title="Logging Services">Logging Services</a></li>
      <li class="pull-right"><span class="divider">|</span>
<a href="https://www.apache.org/" class="externalLink" title="Apache">Apache</a></li>
      <li class="pull-right"><a href="https://cwiki.apache.org/confluence/display/LOGGING/Log4j" class="externalLink" title="Logging Wiki">Logging Wiki</a></li>
          </ul>
        </div>
      </header>
      <div class="row-fluid">
        <header id="leftColumn" class="span2">
          <nav class="well sidebar-nav">
  <ul class="nav nav-list">
   <li class="nav-header"><img class="imageLink" src="img/glyphicons/home.png" alt="Apache Log4j™ 3.x" border="0"/> Apache Log4j™ 3.x</li>
    <li><a href="index.html" title="About"><span class="none"></span>About</a></li>
    <li><a href="download.html" title="Download"><span class="none"></span>Download</a></li>
    <li><a href="javadoc.html" title="Javadoc"><span class="none"></span>Javadoc</a></li>
    <li><a href="maven-artifacts.html" title="Maven, Ivy, Gradle Artifacts"><span class="icon-chevron-right"></span>Maven, Ivy, Gradle Artifacts</a></li>
    <li><a href="runtime-dependencies.html" title="Runtime Dependencies"><span class="none"></span>Runtime Dependencies</a></li>
    <li><a href="release-notes/index.html" title="Release Notes"><span class="none"></span>Release Notes</a></li>
    <li><a href="faq.html" title="FAQ"><span class="none"></span>FAQ</a></li>
    <li><a href="performance.html" title="Performance"><span class="icon-chevron-right"></span>Performance</a></li>
    <li><a href="articles.html" title="Articles and Tutorials"><span class="none"></span>Articles and Tutorials</a></li>
    <li><a href="security.html" title="Security"><span class="none"></span>Security</a></li>
    <li><a href="support.html" title="Support"><span class="none"></span>Support</a></li>
    <li><a href="thanks.html" title="Thanks"><span class="none"></span>Thanks</a></li>
   <li class="nav-header"><img class="imageLink" src="img/glyphicons/pencil.png" alt="For Contributors" border="0"/> For Contributors</li>
    <li><a href="guidelines.html" title="Guidelines"><span class="none"></span>Guidelines</a></li>
    <li><a href="javastyle.html" title="Style Guide"><span class="none"></span>Style Guide</a></li>
   <li class="nav-header"><img class="imageLink" src="img/glyphicons/book.png" alt="Manual" border="0"/> Manual</li>
    <li><a href="manual/index.html" title="Introduction"><span class="none"></span>Introduction</a></li>
    <li><a href="manual/architecture.html" title="Architecture"><span class="none"></span>Architecture</a></li>
    <li><a href="manual/compatibility.html" title="Log4j 1.x Compatibility"><span class="none"></span>Log4j 1.x Compatibility</a></li>
    <li><a href="manual/migration.html" title="Log4j 1.x Migration"><span class="none"></span>Log4j 1.x Migration</a></li>
    <li><a href="manual/api.html" title="Java API"><span class="icon-chevron-right"></span>Java API</a></li>
    <li><a href="manual/scala-api.html" title="Scala API"><span class="none"></span>Scala API</a></li>
    <li><a href="manual/configuration.html" title="Configuration"><span class="icon-chevron-right"></span>Configuration</a></li>
    <li><a href="manual/usage.html" title="Usage"><span class="icon-chevron-right"></span>Usage</a></li>
    <li><a href="manual/webapp.html" title="Web Applications and JSPs"><span class="icon-chevron-right"></span>Web Applications and JSPs</a></li>
    <li><a href="manual/lookups.html" title="Lookups"><span class="icon-chevron-right"></span>Lookups</a></li>
    <li><a href="manual/appenders.html" title="Appenders"><span class="icon-chevron-right"></span>Appenders</a></li>
    <li><a href="manual/layouts.html" title="Layouts"><span class="icon-chevron-right"></span>Layouts</a></li>
    <li><a href="manual/filters.html" title="Filters"><span class="icon-chevron-right"></span>Filters</a></li>
    <li><a href="manual/async.html" title="Async Loggers"><span class="icon-chevron-right"></span>Async Loggers</a></li>
    <li><a href="manual/garbagefree.html" title="Garbage-free Logging"><span class="icon-chevron-right"></span>Garbage-free Logging</a></li>
    <li><a href="manual/jmx.html" title="JMX"><span class="none"></span>JMX</a></li>
    <li><a href="manual/logsep.html" title="Logging Separation"><span class="none"></span>Logging Separation</a></li>
    <li><a href="manual/extending.html" title="Extending Log4j"><span class="icon-chevron-right"></span>Extending Log4j</a></li>
    <li><a href="manual/plugins.html" title="Plugins"><span class="icon-chevron-right"></span>Plugins</a></li>
    <li><a href="manual/customconfig.html" title="Programmatic Log4j Configuration"><span class="icon-chevron-right"></span>Programmatic Log4j Configuration</a></li>
    <li><a href="manual/customloglevels.html" title="Custom Log Levels"><span class="icon-chevron-right"></span>Custom Log Levels</a></li>
   <li class="nav-header"><img class="imageLink" src="img/glyphicons/tag.png" alt="Related Projects" border="0"/> Related Projects</li>
    <li><a href="http://logging.apache.org/log4j/scala/index.html" class="externalLink" title="Log4j-Scala"><span class="none"></span>Log4j-Scala</a></li>
   <li class="nav-header"><img class="imageLink" src="img/glyphicons/link.png" alt="Older Releases" border="0"/> Older Releases</li>
    <li><a href="http://logging.apache.org/log4j/1.2/" class="externalLink" title="Log4j 1.2 - End of Life"><span class="none"></span>Log4j 1.2 - End of Life</a></li>
    <li><a href="http://logging.apache.org/log4j/log4j-2.3/" class="externalLink" title="Log4j 2.3 - Java 6"><span class="none"></span>Log4j 2.3 - Java 6</a></li>
    <li><a href="http://logging.apache.org/log4j/log4j-2.12.1/" class="externalLink" title="Log4j 2.12.1 - Java 7"><span class="none"></span>Log4j 2.12.1 - Java 7</a></li>
    <li><a href="http://logging.apache.org/log4j/2.x/" class="externalLink" title="Log4j 2.x - Latest release for Java 8"><span class="none"></span>Log4j 2.x - Latest release for Java 8</a></li>
   <li class="nav-header"><img class="imageLink" src="img/glyphicons/cog.png" alt="Components" border="0"/> Components</li>
    <li><a href="log4j-api.html" title="API"><span class="none"></span>API</a></li>
    <li><a href="log4j-core.html" title="Implementation"><span class="none"></span>Implementation</a></li>
    <li><a href="log4j-jcl.html" title="Commons Logging Bridge"><span class="none"></span>Commons Logging Bridge</a></li>
    <li><a href="log4j-1.2-api.html" title="Log4j 1.2 API"><span class="none"></span>Log4j 1.2 API</a></li>
    <li><a href="log4j-slf4j-impl.html" title="SLF4J Binding"><span class="none"></span>SLF4J Binding</a></li>
    <li><a href="log4j-jul.html" title="JUL Adapter"><span class="none"></span>JUL Adapter</a></li>
    <li><a href="log4j-jpl.html" title="JDK Platform Logger"><span class="none"></span>JDK Platform Logger</a></li>
    <li><a href="log4j-to-slf4j.html" title="Log4j 2 to SLF4J Adapter"><span class="none"></span>Log4j 2 to SLF4J Adapter</a></li>
    <li><a href="log4j-jdbc-dbcp2.html" title="JDBC Appender"><span class="none"></span>JDBC Appender</a></li>
    <li><a href="log4j-jeromq.html" title="ZeroMQ Appender"><span class="none"></span>ZeroMQ Appender</a></li>
    <li><a href="log4j-flume-ng.html" title="Apache Flume Appender"><span class="none"></span>Apache Flume Appender</a></li>
    <li><a href="log4j-jms.html" title="JMS Appender"><span class="none"></span>JMS Appender</a></li>
    <li><a href="log4j-taglib.html" title="Tag Library"><span class="none"></span>Tag Library</a></li>
    <li><a href="log4j-jmx-gui.html" title="JMX GUI"><span class="none"></span>JMX GUI</a></li>
    <li><a href="log4j-web.html" title="Web Application Support"><span class="none"></span>Web Application Support</a></li>
    <li><a href="log4j-jakarta-web.html" title="Jakarta Web Application Support"><span class="none"></span>Jakarta Web Application Support</a></li>
    <li><a href="log4j-appserver.html" title="Application Server Integration"><span class="none"></span>Application Server Integration</a></li>
    <li><a href="log4j-couchdb.html" title="CouchDB appender"><span class="none"></span>CouchDB appender</a></li>
    <li><a href="log4j-mongodb3.html" title="MongoDB3 appender"><span class="none"></span>MongoDB3 appender</a></li>
    <li><a href="log4j-mongodb4.html" title="MongoDB4 appender"><span class="none"></span>MongoDB4 appender</a></li>
    <li><a href="log4j-cassandra.html" title="Cassandra appender"><span class="none"></span>Cassandra appender</a></li>
    <li><a href="log4j-iostreams.html" title="IO Streams"><span class="none"></span>IO Streams</a></li>
    <li><a href="log4j-liquibase.html" title="Liquibase Binding"><span class="none"></span>Liquibase Binding</a></li>
    <li><a href="log4j-docker.html" title="Docker Support"><span class="none"></span>Docker Support</a></li>
    <li class="active"><a href="#"><span class="none"></span>Kubernetes Support</a></li>
    <li><a href="log4j-spring-boot.html" title="Log4j Spring Boot"><span class="none"></span>Log4j Spring Boot</a></li>
    <li><a href="log4j-spring-cloud-config-client.html" title="Spring Cloud Config Client"><span class="none"></span>Spring Cloud Config Client</a></li>
    <li><a href="log4j-transform" title="Log4j Transformation Tools"><span class="none"></span>Log4j Transformation Tools</a></li>
   <li class="nav-header"><img class="imageLink" src="img/glyphicons/info.png" alt="Project Information" border="0"/> Project Information</li>
    <li><a href="team.html" title="Project Team"><span class="none"></span>Project Team</a></li>
    <li><a href="https://www.apache.org/licenses/LICENSE-2.0" class="externalLink" title="Project License"><span class="none"></span>Project License</a></li>
    <li><a href="https://github.com/apache/logging-log4j2/tree/main" class="externalLink" title="Source Repository"><span class="none"></span>Source Repository</a></li>
   <li class="nav-header"><img class="imageLink" src="img/glyphicons/layers.png" alt="Project Reports" border="0"/> Project Reports</li>
    <li><a href="rat-report.html" title="RAT Report"><span class="none"></span>RAT Report</a></li>
  </ul>
          </nav>
          <div class="well sidebar-nav">
            <hr />
            <div id="poweredBy">
              <div class="clear"></div>
              <div class="clear"></div>
              <div class="clear"></div>
<a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy"><img class="builtBy" alt="Built by Maven" src="./images/logos/maven-feather.png" /></a>
            </div>
          </div>
        </header>
        <main id="bodyColumn"  class="span10" >
<!-- vim: set syn=markdown : -->
<!--
    Licensed to the Apache Software Foundation (ASF) under one or more
    contributor license agreements.  See the NOTICE file distributed with
    this work for additional information regarding copyright ownership.
    The ASF licenses this file to You under the Apache License, Version 2.0
    (the "License"); you may not use this file except in compliance with
    the License.  You may obtain a copy of the License at

         http://www.apache.org/licenses/LICENSE-2.0

    Unless required by applicable law or agreed to in writing, software
    distributed under the License is distributed on an "AS IS" BASIS,
    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    See the License for the specific language governing permissions and
    limitations under the License.
-->
<h1>Log4j Kubernetes Support</h1>
<p>Log4j supports Kubernetes by providing a Lookup to retrieve container information.</p><section>
<h2><a name="Accessing_Kubernetes"></a>Accessing Kubernetes</h2>
<p>The Log4j Kubernetes support requires access to the Docker REST interface. In many cases the REST service
can be accessed automatically. If needed the Kubernetes client can be configured any of the standard
Log4j configuration locations or via the Spring Boot configuration. Note, however, that since Spring Boot
causes logging to initialize 3 times and since the Spring environment is only available during the last
Log4j initialization Spring properties will only be available to Log4j in the last initialization.</p></section><section>
<h2><a name="Lookup_Attributes"></a>Lookup Attributes</h2>
<p>Log4j Kubernetes provides access to the following container attributes:</p>
<ul>

<li>accountName - The service account name.</li>
<li>clusterName - The name of the cluster the application is running in.</li>
<li>containerId - The full id assigned to the container.</li>
<li>containerName - The name assigned to the container.</li>
<li>host - The name of the host.</li>
<li>hostIp - The host's ip address.</li>
<li>imageId - The id assigned to the image.</li>
<li>imageName - The name assigned to the image.</li>
<li>labels - All labels formatted in a list.</li>
<li>labels.app - The application name.</li>
<li>labels.podTemplateHash - The pod's template hash value.</li>
<li>masterUrl - The url needed to access the API server.</li>
<li>namespaceId - The id of the namespace the various kubernetes components are located within.</li>
<li>namespaceName - The namespace the various kubernetes components are located within.</li>
<li>podId - The pod's id number.</li>
<li>podIp - The pod's ip address.</li>
<li>podName - The name of the pod.</li>
</ul>
<p>Attributes may be accessed by adding</p>

<div class="source"><pre class="prettyprint"><code>${k8s:containerId}
</code></pre></div>
<p>to the configuration. Note that kubernetes variables are only resolved once during logging initialization so they
shouldn't be referenced with more than one &#x2018;$&#x2019; character.</p></section><section>
<h2><a name="Configuration"></a>Configuration</h2>
<p>Much of the configuration needed to access the Kubernetes API server is provided automatically by Kubernetes.
However, it is not uncommon to need to provide the url required to access the Kubernetes API server or the
namespace the application is assigned to. The properties below may either be configured using the Log4j
variable names and located by Log4j's normal property resolution mechansim or Log4j will resolve the
spring properties when the application is running in Spring Boot and the Spring Environment has been created.
Note that Spring Boot initializes logging 3 times and only the last will have a Spring Environment present.</p>
<table border="0" class="table table-striped">
<thead>

<tr class="a">
<th>Log4j Property Name</th>
<th align="right">Spring Property Name</th>
<th align="right">Default</th>
<th align="right">Description</th></tr>
</thead><tbody>

<tr class="b">
<td align="left">log4j2.kubernetes.client.apiVersion</td>
<td align="right">spring.cloud.kubernetes.client.apiVersion</td>
<td align="right">v1</td>
<td align="right">Kubernetes API Version</td></tr>
<tr class="a">
<td align="left">log4j2.kubernetes.client.caCertData</td>
<td align="right">spring.cloud.kubernetes.client.caCertData</td>
<td align="right"> </td>
<td align="right">Kubernetes API CACertData</td></tr>
<tr class="b">
<td align="left">log4j2.kubernetes.client.caCertFile</td>
<td align="right">spring.cloud.kubernetes.client.caCertFile</td>
<td align="right"> </td>
<td align="right">Kubernetes API CACertFile</td></tr>
<tr class="a">
<td align="left">log4j2.kubernetes.client.clientCertData</td>
<td align="right">spring.cloud.kubernetes.client.clientCertData</td>
<td align="right"> </td>
<td align="right">Kubernetes API ClientCertData</td></tr>
<tr class="b">
<td align="left">log4j2.kubernetes.client.clientCertFile</td>
<td align="right">spring.cloud.kubernetes.client.clientCertFile</td>
<td align="right"> </td>
<td align="right">Kubernetes API ClientCertFile</td></tr>
<tr class="a">
<td align="left">log4j2.kubernetes.client.clientKeyAlgo</td>
<td align="right">spring.cloud.kubernetes.client.clientKeyAlgo</td>
<td align="right">RSA</td>
<td align="right">Kubernetes API ClientKeyAlgo</td></tr>
<tr class="b">
<td align="left">log4j2.kubernetes.client.clientKeyData</td>
<td align="right">spring.cloud.kubernetes.client.clientKeyData</td>
<td align="right"> </td>
<td align="right">Kubernetes API ClientKeyData</td></tr>
<tr class="a">
<td align="left">log4j2.kubernetes.client.clientKeyFile</td>
<td align="right">spring.cloud.kubernetes.client.clientKeyFile</td>
<td align="right"> </td>
<td align="right">Kubernetes API ClientKeyFile</td></tr>
<tr class="b">
<td align="left">log4j2.kubernetes.client.clientKeyPassPhrase</td>
<td align="right">spring.cloud.kubernetes.client.clientKeyPassphrase</td>
<td align="right">changeit</td>
<td align="right">Kubernetes API ClientKeyPassphrase</td></tr>
<tr class="a">
<td align="left">log4j2.kubernetes.client.connectionTimeout</td>
<td align="right">spring.cloud.kubernetes.client.connectionTimeout</td>
<td align="right">10s</td>
<td align="right">Connection timeout</td></tr>
<tr class="b">
<td align="left">log4j2.kubernetes.client.httpProxy</td>
<td align="right">spring.cloud.kubernetes.client.http-proxy</td>
<td align="right"> </td>
<td align="right"> </td></tr>
<tr class="a">
<td align="left">log4j2.kubernetes.client.httpsProxy</td>
<td align="right">spring.cloud.kubernetes.client.https-proxy</td>
<td align="right"> </td>
<td align="right"> </td></tr>
<tr class="b">
<td align="left">log4j2.kubernetes.client.loggingInberval</td>
<td align="right">spring.cloud.kubernetes.client.loggingInterval</td>
<td align="right">20s</td>
<td align="right">Logging interval</td></tr>
<tr class="a">
<td align="left">log4j2.kubernetes.client.masterUrl</td>
<td align="right">spring.cloud.kubernetes.client.masterUrl</td>
<td align="right">kubernetes.default.svc</td>
<td align="right">Kubernetes API Master Node URL</td></tr>
<tr class="b">
<td align="left">log4j2.kubernetes.client.namespacce</td>
<td align="right">spring.cloud.kubernetes.client.namespace</td>
<td align="right">default</td>
<td align="right">Kubernetes Namespace</td></tr>
<tr class="a">
<td align="left">log4j2.kubernetes.client.noProxy</td>
<td align="right">spring.cloud.kubernetes.client.noProxy</td>
<td align="right"> </td>
<td align="right"> </td></tr>
<tr class="b">
<td align="left">log4j2.kubernetes.client.password</td>
<td align="right">spring.cloud.kubernetes.client.password</td>
<td align="right"> </td>
<td align="right">Kubernetes API Password</td></tr>
<tr class="a">
<td align="left">log4j2.kubernetes.client.proxyPassword</td>
<td align="right">spring.cloud.kubernetes.client.proxyPassword</td>
<td align="right"> </td>
<td align="right"> </td></tr>
<tr class="b">
<td align="left">log4j2.kubernetes.client.proxyUsername</td>
<td align="right">spring.cloud.kubernetes.client.proxyUsername</td>
<td align="right"> </td>
<td align="right"> </td></tr>
<tr class="a">
<td align="left">log4j2.kubernetes.client.requestTimeout</td>
<td align="right">spring.cloud.kubernetes.client.requestTimeout</td>
<td align="right">10s</td>
<td align="right">Request timeout</td></tr>
<tr class="b">
<td align="left">log4j2.kubernetes.client.rollingTimeout</td>
<td align="right">spring.cloud.kubernetes.client.rollingTimeout</td>
<td align="right">900s</td>
<td align="right">Rolling timeout</td></tr>
<tr class="a">
<td align="left">log4j2.kubernetes.client.trustCerts</td>
<td align="right">spring.cloud.kubernetes.client.trustCerts</td>
<td align="right">false</td>
<td align="right">Kubernetes API Trust Certificates</td></tr>
<tr class="b">
<td align="left">log4j2.kubernetes.client.username</td>
<td align="right">spring.cloud.kubernetes.client.username</td>
<td align="right"> </td>
<td align="right">Kubernetes API Username</td></tr>
<tr class="a">
<td align="left">log4j2.kubernetes.client.watchReconnectInterval</td>
<td align="right">spring.cloud.kubernetes.client.watchReconnectInterval</td>
<td align="right">1s</td>
<td align="right">Reconnect Interval</td></tr>
<tr class="b">
<td align="left">log4j2.kubernetes.client.watchReconnectLimit</td>
<td align="right">spring.cloud.kubernetes.client.watchReconnectLimit</td>
<td align="right">-1</td>
<td align="right">Reconnect Interval limit retries</td></tr>
</tbody>
</table></section><section>
<h2><a name="Requirements"></a>Requirements</h2>
<p>Log4j Kubernetes requires Log4j Core, Log4j API and a minimum of Java 8.
For more information, see <a href="runtime-dependencies.html">Runtime Dependencies</a>.</p></section>
        </main>
      </div>
    </div>
    <hr/>
    <footer>
      <div class="container-fluid">
        <div class="row-fluid">
<p align="center">Copyright &copy; 1999-2023 <a class="external" href="http://www.apache.org">The Apache Software Foundation</a>. All Rights Reserved.<br>
      Apache Logging, Apache Log4j, Log4j, Apache, the Apache feather logo, and the Apache Logging project logo are trademarks of The Apache Software Foundation.</p>
        </div>
      </div>
    </footer>
  </body>
</html>
