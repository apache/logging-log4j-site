<!DOCTYPE html>
<!--
 | Generated by Apache Maven Doxia Site Renderer 1.11.1 from target/generated-sources/site/asciidoc/manual/migration.adoc at 2023-06-03
 | Rendered using Apache Maven Fluido Skin 1.8
-->
<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="generator" content="Apache Maven Doxia Site Renderer 1.11.1" />
    <title>Log4j &#x2013; </title>
    <link rel="stylesheet" href="../css/apache-maven-fluido-1.8.min.css" />
    <link rel="stylesheet" href="../css/site.css" />
    <link rel="stylesheet" href="../css/print.css" media="print" />
    <script src="../js/apache-maven-fluido-1.8.min.js"></script>
  </head>
  <body class="topBarDisabled">
    <div class="container-fluid">
      <header>
        <div id="banner">
          <div class="pull-left"><a href="http://logging.apache.org" id="bannerLeft"><img src="../images/ls-logo.jpg"  alt=""/></a></div>
          <div class="pull-right"><a href="http://logging.apache.org/log4j/3.x" id="bannerRight"><img src="../images/logo.png"  alt=""/></a></div>
          <div class="clear"><hr/></div>
        </div>

        <div id="breadcrumbs">
          <ul class="breadcrumb">
        <li id="publishDate">Last Published: 2023-06-03<span class="divider">|</span>
</li>
          <li id="projectVersion">Version: 3.0.0-SNAPSHOT</li>
      <li class="pull-right"><span class="divider">|</span>
<a href="https://github.com/apache/logging-log4j2" class="externalLink" title="GitHub">GitHub</a></li>
      <li class="pull-right"><span class="divider">|</span>
<a href="https://analysis.apache.org/dashboard/index/org.apache.logging.log4j:log4j" class="externalLink" title="Sonar">Sonar</a></li>
      <li class="pull-right"><span class="divider">|</span>
<a href="../../../" title="Logging Services">Logging Services</a></li>
      <li class="pull-right"><span class="divider">|</span>
<a href="https://www.apache.org/" class="externalLink" title="Apache">Apache</a></li>
      <li class="pull-right"><a href="https://cwiki.apache.org/confluence/display/LOGGING/Log4j" class="externalLink" title="Logging Wiki">Logging Wiki</a></li>
          </ul>
        </div>
      </header>
      <div class="row-fluid">
        <header id="leftColumn" class="span2">
          <nav class="well sidebar-nav">
  <ul class="nav nav-list">
   <li class="nav-header"><img class="imageLink" src="../img/glyphicons/home.png" alt="Apache Log4j™ 3.x" border="0"/> Apache Log4j™ 3.x</li>
    <li><a href="../index.html" title="About"><span class="none"></span>About</a></li>
    <li><a href="../download.html" title="Download"><span class="none"></span>Download</a></li>
    <li><a href="../javadoc.html" title="Javadoc"><span class="none"></span>Javadoc</a></li>
    <li><a href="../maven-artifacts.html" title="Maven, Ivy, Gradle Artifacts"><span class="icon-chevron-right"></span>Maven, Ivy, Gradle Artifacts</a></li>
    <li><a href="../runtime-dependencies.html" title="Runtime Dependencies"><span class="none"></span>Runtime Dependencies</a></li>
    <li><a href="../release-notes/" title="Release Notes"><span class="none"></span>Release Notes</a></li>
    <li><a href="../faq.html" title="FAQ"><span class="none"></span>FAQ</a></li>
    <li><a href="../performance.html" title="Performance"><span class="icon-chevron-right"></span>Performance</a></li>
    <li><a href="../articles.html" title="Articles and Tutorials"><span class="none"></span>Articles and Tutorials</a></li>
    <li><a href="../security.html" title="Security"><span class="none"></span>Security</a></li>
    <li><a href="../support.html" title="Support"><span class="none"></span>Support</a></li>
    <li><a href="../thanks.html" title="Thanks"><span class="none"></span>Thanks</a></li>
   <li class="nav-header"><img class="imageLink" src="../img/glyphicons/pencil.png" alt="For Contributors" border="0"/> For Contributors</li>
    <li><a href="../guidelines.html" title="Guidelines"><span class="none"></span>Guidelines</a></li>
    <li><a href="../javastyle.html" title="Style Guide"><span class="none"></span>Style Guide</a></li>
   <li class="nav-header"><img class="imageLink" src="../img/glyphicons/book.png" alt="Manual" border="0"/> Manual</li>
    <li><a href="../manual/index.html" title="Introduction"><span class="none"></span>Introduction</a></li>
    <li><a href="../manual/architecture.html" title="Architecture"><span class="none"></span>Architecture</a></li>
    <li><a href="../manual/compatibility.html" title="Log4j 1.x Compatibility"><span class="none"></span>Log4j 1.x Compatibility</a></li>
    <li class="active"><a href="#"><span class="none"></span>Log4j 1.x Migration</a></li>
    <li><a href="../manual/api.html" title="Java API"><span class="icon-chevron-right"></span>Java API</a></li>
    <li><a href="../manual/scala-api.html" title="Scala API"><span class="none"></span>Scala API</a></li>
    <li><a href="../manual/configuration.html" title="Configuration"><span class="icon-chevron-right"></span>Configuration</a></li>
    <li><a href="../manual/usage.html" title="Usage"><span class="icon-chevron-right"></span>Usage</a></li>
    <li><a href="../manual/webapp.html" title="Web Applications and JSPs"><span class="icon-chevron-right"></span>Web Applications and JSPs</a></li>
    <li><a href="../manual/lookups.html" title="Lookups"><span class="icon-chevron-right"></span>Lookups</a></li>
    <li><a href="../manual/appenders.html" title="Appenders"><span class="icon-chevron-right"></span>Appenders</a></li>
    <li><a href="../manual/layouts.html" title="Layouts"><span class="icon-chevron-right"></span>Layouts</a></li>
    <li><a href="../manual/filters.html" title="Filters"><span class="icon-chevron-right"></span>Filters</a></li>
    <li><a href="../manual/async.html" title="Async Loggers"><span class="icon-chevron-right"></span>Async Loggers</a></li>
    <li><a href="../manual/garbagefree.html" title="Garbage-free Logging"><span class="icon-chevron-right"></span>Garbage-free Logging</a></li>
    <li><a href="../manual/jmx.html" title="JMX"><span class="none"></span>JMX</a></li>
    <li><a href="../manual/logsep.html" title="Logging Separation"><span class="none"></span>Logging Separation</a></li>
    <li><a href="../manual/extending.html" title="Extending Log4j"><span class="icon-chevron-right"></span>Extending Log4j</a></li>
    <li><a href="../manual/plugins.html" title="Plugins"><span class="icon-chevron-right"></span>Plugins</a></li>
    <li><a href="../manual/customconfig.html" title="Programmatic Log4j Configuration"><span class="icon-chevron-right"></span>Programmatic Log4j Configuration</a></li>
    <li><a href="../manual/customloglevels.html" title="Custom Log Levels"><span class="icon-chevron-right"></span>Custom Log Levels</a></li>
   <li class="nav-header"><img class="imageLink" src="../img/glyphicons/tag.png" alt="Related Projects" border="0"/> Related Projects</li>
    <li><a href="http://logging.apache.org/log4j/scala/index.html" class="externalLink" title="Log4j-Scala"><span class="none"></span>Log4j-Scala</a></li>
   <li class="nav-header"><img class="imageLink" src="../img/glyphicons/link.png" alt="Legacy" border="0"/> Legacy</li>
    <li><a href="http://logging.apache.org/log4j/1.2/" class="externalLink" title="Log4j 1.2 - End of Life"><span class="none"></span>Log4j 1.2 - End of Life</a></li>
    <li><a href="http://logging.apache.org/log4j/log4j-2.3/" class="externalLink" title="Log4j 2.3 - Java 6"><span class="none"></span>Log4j 2.3 - Java 6</a></li>
    <li><a href="http://logging.apache.org/log4j/log4j-2.12.1/" class="externalLink" title="Log4j 2.12.1 - Java 7"><span class="none"></span>Log4j 2.12.1 - Java 7</a></li>
   <li class="nav-header"><img class="imageLink" src="../img/glyphicons/cog.png" alt="Components" border="0"/> Components</li>
    <li><a href="../log4j-api.html" title="API"><span class="none"></span>API</a></li>
    <li><a href="../log4j-core.html" title="Implementation"><span class="none"></span>Implementation</a></li>
    <li><a href="../log4j-jcl.html" title="Commons Logging Bridge"><span class="none"></span>Commons Logging Bridge</a></li>
    <li><a href="../log4j-1.2-api.html" title="Log4j 1.2 API"><span class="none"></span>Log4j 1.2 API</a></li>
    <li><a href="../log4j-slf4j-impl.html" title="SLF4J Binding"><span class="none"></span>SLF4J Binding</a></li>
    <li><a href="../log4j-jul.html" title="JUL Adapter"><span class="none"></span>JUL Adapter</a></li>
    <li><a href="../log4j-jpl.html" title="JDK Platform Logger"><span class="none"></span>JDK Platform Logger</a></li>
    <li><a href="../log4j-to-slf4j.html" title="Log4j 2 to SLF4J Adapter"><span class="none"></span>Log4j 2 to SLF4J Adapter</a></li>
    <li><a href="../log4j-jdbc-dbcp2.html" title="JDBC Appender"><span class="none"></span>JDBC Appender</a></li>
    <li><a href="../log4j-jeromq.html" title="ZeroMQ Appender"><span class="none"></span>ZeroMQ Appender</a></li>
    <li><a href="../log4j-flume-ng.html" title="Apache Flume Appender"><span class="none"></span>Apache Flume Appender</a></li>
    <li><a href="../log4j-jms.html" title="JMS Appender"><span class="none"></span>JMS Appender</a></li>
    <li><a href="../log4j-taglib.html" title="Tag Library"><span class="none"></span>Tag Library</a></li>
    <li><a href="../log4j-jmx-gui.html" title="JMX GUI"><span class="none"></span>JMX GUI</a></li>
    <li><a href="../log4j-web.html" title="Web Application Support"><span class="none"></span>Web Application Support</a></li>
    <li><a href="../log4j-jakarta-web.html" title="Jakarta Web Application Support"><span class="none"></span>Jakarta Web Application Support</a></li>
    <li><a href="../log4j-appserver.html" title="Application Server Integration"><span class="none"></span>Application Server Integration</a></li>
    <li><a href="../log4j-couchdb.html" title="CouchDB appender"><span class="none"></span>CouchDB appender</a></li>
    <li><a href="../log4j-mongodb3.html" title="MongoDB3 appender"><span class="none"></span>MongoDB3 appender</a></li>
    <li><a href="../log4j-mongodb4.html" title="MongoDB4 appender"><span class="none"></span>MongoDB4 appender</a></li>
    <li><a href="../log4j-cassandra.html" title="Cassandra appender"><span class="none"></span>Cassandra appender</a></li>
    <li><a href="../log4j-iostreams.html" title="IO Streams"><span class="none"></span>IO Streams</a></li>
    <li><a href="../log4j-liquibase.html" title="Liquibase Binding"><span class="none"></span>Liquibase Binding</a></li>
    <li><a href="../log4j-docker.html" title="Docker Support"><span class="none"></span>Docker Support</a></li>
    <li><a href="../log4j-kubernetes.html" title="Kubernetes Support"><span class="none"></span>Kubernetes Support</a></li>
    <li><a href="../log4j-spring-boot.html" title="Log4j Spring Boot"><span class="none"></span>Log4j Spring Boot</a></li>
    <li><a href="../log4j-spring-cloud-config-client.html" title="Spring Cloud Config Client"><span class="none"></span>Spring Cloud Config Client</a></li>
    <li><a href="../log4j-transform" title="Log4j Transformation Tools"><span class="none"></span>Log4j Transformation Tools</a></li>
   <li class="nav-header"><img class="imageLink" src="../img/glyphicons/info.png" alt="Project Information" border="0"/> Project Information</li>
    <li><a href="../team.html" title="Project Team"><span class="none"></span>Project Team</a></li>
    <li><a href="https://www.apache.org/licenses/LICENSE-2.0" class="externalLink" title="Project License"><span class="none"></span>Project License</a></li>
    <li><a href="https://github.com/apache/logging-log4j2/tree/main" class="externalLink" title="Source Repository"><span class="none"></span>Source Repository</a></li>
   <li class="nav-header"><img class="imageLink" src="../img/glyphicons/layers.png" alt="Project Reports" border="0"/> Project Reports</li>
    <li><a href="../rat-report.html" title="RAT Report"><span class="none"></span>RAT Report</a></li>
  </ul>
          </nav>
          <div class="well sidebar-nav">
            <hr />
            <div id="poweredBy">
              <div class="clear"></div>
              <div class="clear"></div>
              <div class="clear"></div>
<a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy"><img class="builtBy" alt="Built by Maven" src="../images/logos/maven-feather.png" /></a>
            </div>
          </div>
        </header>
        <main id="bodyColumn"  class="span10" >
<h1>Migrating from Log4j 1.x</h1>
<div id="preamble">
<div class="sectionbody">
<link rel="stylesheet" type="text/css" href="../css/tables.css">
</div>
</div>
<div class="sect1 2Bridge">
<h2 id="Log4j1">When to use this the Log4j 1.x bridge</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This bridge is useful as a dependency of an "application" which would like to use Log4j v2 as its main logging framework, if either that application itself hasn&#8217;t been changed from using the Log4j 1.x API to the 1.x API, or if such an application depends on one or several (perhaps old) libraries that are "out of your control", and which themselves still contain code and thus a compile dependency on Log 1.x only.</p>
</div>
<div class="paragraph">
<p>Once you have migrated all of your own application &amp; library code under your control, you may not need this bridge. Note that when you use a library/framework that can be configured to use several logging frameworks, then you typically don&#8217;t need this bridge either anymore, as you may be able to directly configure it to use Log4j v2 instead v1.  Some libraries/frameworks even auto-detect the presence of certain logging framework implementations on their classpath, and automagically switch their internal logging delegation accordingly; try simple removing the Log4j v1 dependency instead of replacing it with this bridge, and test if logging from all of your depenencies still work.</p>
</div>
<div class="paragraph">
<p>If you own or can contribute open source to the library you depend on, then you likely would prefer replacing its use of the Log4j v1 Logging API with the v2 API. (It typically does not make sense for libraries to depend on this bridge and support both the v1 and v2 Log4j API, because end-users of such a library would still have to replace their Log4j configuration v1 with a different v2 config anyway; see below.)</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="using_the_log4j_1_x_bridge">Using the Log4j 1.x bridge</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Perhaps the simplest way to convert to using Log4j 2 is to replace the
log4j 1.x jar file with Log4j 2&#8217;s <code>log4j-1.2-api.jar</code>. However, to use
this successfully applications must meet the following requirements:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>They must not access methods and classes internal to the Log4j 1.x
implementation such as <code>Appender`s, `LoggerRepository</code> or <code>Category&#8217;s
`callAppenders</code> method.</p>
</li>
<li>
<p>They must not programmatically configure Log4j.</p>
</li>
<li>
<p>They must not configure by calling the classes <code>DOMConfigurator</code> or
<code>PropertyConfigurator</code>.</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect1">
<h2 id="converting_to_the_log4j_2_api">Converting to the Log4j 2 API</h2>
<div class="sectionbody">
<div class="paragraph">
<p>For the most part, converting from the Log4j 1.x API to Log4j 2 should
be fairly simple. Many of the log statements will require no
modification. However, where necessary the following changes must be
made.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>The main package in version 1 is <code>org.apache.log4j</code>, in version 2 it
is <code>org.apache.logging.log4j</code></p>
</li>
<li>
<p>Calls to <code>org.apache.log4j.Logger.getLogger()</code> must be modified to
<code>org.apache.logging.log4j.LogManager.getLogger()</code>.</p>
</li>
<li>
<p>Calls to <code>org.apache.log4j.Logger.getRootLogger()</code> or
<code>org.apache.log4j.LogManager.getRootLogger()</code> must be replaced with
<code>org.apache.logging.log4j.LogManager.getRootLogger()</code>.</p>
</li>
<li>
<p>Calls to <code>org.apache.log4j.Logger.getLogger</code> that accept a
<code>LoggerFactory</code> must remove the <code>org.apache.log4j.spi.LoggerFactory</code> and
use one of Log4j 2&#8217;s other extension mechanisms.</p>
</li>
<li>
<p>Replace calls to <code>org.apache.log4j.Logger.getEffectiveLevel()</code> with
<code>org.apache.logging.log4j.Logger.getLevel()</code>.</p>
</li>
<li>
<p>Remove calls to <code>org.apache.log4j.LogManager.shutdown()</code>, they are
not needed in version 2 because the Log4j Core now automatically adds a
JVM shutdown hook on start up to perform any Core clean ups.</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Starting in Log4j 2.1, you can specify a custom
<a href="../log4j-core/apidocs/org/apache/logging/log4j/core/util/ShutdownCallbackRegistry.html"><code>ShutdownCallbackRegistry</code></a>
to override the default JVM shutdown hook strategy.</p>
</li>
<li>
<p>Starting in Log4j 2.6, you can now use
<code>org.apache.logging.log4j.LogManager.shutdown()</code> to initiate shutdown
manually.</p>
</li>
</ol>
</div>
</li>
<li>
<p>Calls to <code>org.apache.log4j.Logger.setLevel()</code> or similar methods are
not supported in the API. Applications should remove these. Equivalent
functionality is provided in the Log4j 2 implementation classes, see
<code>org.apache.logging.log4j.core.config.Configurator.setLevel()</code>, but may
leave the application susceptible to changes in Log4j 2 internals.</p>
</li>
<li>
<p>Where appropriate, applications should convert to use parameterized
messages instead of String concatenation.</p>
</li>
<li>
<p><a href="http://logging.apache.org/log4j/1.2/apidocs/org/apache/log4j/MDC.html"><code>org.apache.log4j.MDC</code></a>
and
<a href="http://logging.apache.org/log4j/1.2/apidocs/org/apache/log4j/NDC.html"><code>org.apache.log4j.NDC</code></a>
have been replaced by the <a href="thread-context.html">Thread Context</a>.</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect1">
<h2 id="configuring_log4j_2">Configuring Log4j 2</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Although the Log4j 2 configuration syntax is different than that of
Log4j 1.x, most, if not all, of the same functionality is available.</p>
</div>
<div class="paragraph">
<p>Note that system property interpolation via the <code>${foo}</code> syntax has been
extended to allow property lookups from many different sources. See the
<a href="lookups.html">Lookups</a> documentation for more details. For example,
using a lookup for the system property named <code>catalina.base</code>, in Log4j
1.x, the syntax would be <code>${catalina.base}</code>. In Log4j 2, the syntax
would be <code>${sys:catalina.base}</code>.</p>
</div>
<div class="paragraph">
<p>Log4j 1.x has a XMLLayout which is different from the XmlLayout in Log4j
2, the log4j-1.2-api module contains a <code>Log4j1XmlLayout</code> which produce
output in the format as in Log4j 1.x. The Log4j 1.x <code>SimpleLayout</code> can
be emulated with PatternLayout "%level - %m%n". The Log4j 1.x
<code>TTCCLayout</code> can be emulated with PatternLayout "%r [%t] %p %c
%notEmpty\{%ndc }- %m%n".</p>
</div>
<div class="paragraph">
<p>Both <code>PatternLayout</code> and <code>EnhancedPatternLayout</code> in Log4j 1.x can be
replaced with <code>PatternLayout</code> in Log4j 2. The log4j-1.2-api module
contains two pattern conversions "%ndc" and "%properties" which can be
used to emulate "%x" and "%X" in Log4j 1.x PatternLayout ("%x" and %X"
in Log4j 2 have a slightly different format).</p>
</div>
<div class="paragraph">
<p>Below are the example configurations for Log4j 1.x and their
counterparts in Log4j 2.</p>
</div>
<div class="sect2">
<h3 id="sample_1_simple_configuration_using_a_console_appender">Sample 1 - Simple configuration using a Console Appender</h3>
<div class="paragraph">
<p>Log4j 1.x XML configuration</p>
</div>
<div class="listingblock">
<div class="title">log4j.xml</div>
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;!DOCTYPE log4j:configuration PUBLIC "-//APACHE//DTD LOG4J 1.2//EN" "log4j.dtd"&gt;
&lt;log4j:configuration xmlns:log4j='http://jakarta.apache.org/log4j/'&gt;
  &lt;appender name="STDOUT" class="org.apache.log4j.ConsoleAppender"&gt;
    &lt;layout class="org.apache.log4j.PatternLayout"&gt;
      &lt;param name="ConversionPattern" value="%d %-5p [%t] %C{2} (%F:%L) - %m%n"/&gt;
    &lt;/layout&gt;
  &lt;/appender&gt;
  &lt;category name="org.apache.log4j.xml"&gt;
    &lt;priority value="info" /&gt;
  &lt;/category&gt;
  &lt;Root&gt;
    &lt;priority value ="debug" /&gt;
    &lt;appender-ref ref="STDOUT" /&gt;
  &lt;/Root&gt;
&lt;/log4j:configuration&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Log4j 2 XML configuration</p>
</div>
<div class="listingblock">
<div class="title">log4j2.xml</div>
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;Configuration&gt;
  &lt;Appenders&gt;
    &lt;Console name="STDOUT" target="SYSTEM_OUT"&gt;
      &lt;PatternLayout pattern="%d %-5p [%t] %C{2} (%F:%L) - %m%n"/&gt;
    &lt;/Console&gt;
  &lt;/Appenders&gt;
  &lt;Loggers&gt;
    &lt;Logger name="org.apache.log4j.xml" level="info"/&gt;
    &lt;Root level="debug"&gt;
      &lt;AppenderRef ref="STDOUT"/&gt;
    &lt;/Root&gt;
  &lt;/Loggers&gt;
&lt;/Configuration&gt;</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="sample_2_simple_configuration_using_a_file_appender_xmllayout_and_simplelayout">Sample 2 - Simple configuration using a File Appender, XMLLayout and SimpleLayout</h3>
<div class="paragraph">
<p>Log4j 1.x XML configuration</p>
</div>
<div class="listingblock">
<div class="title">log4j.xml</div>
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;!DOCTYPE log4j:configuration PUBLIC "-//APACHE//DTD LOG4J 1.2//EN" "log4j.dtd"&gt;
&lt;log4j:configuration xmlns:log4j="http://jakarta.apache.org/log4j/"&gt;
  &lt;appender name="A1" class="org.apache.log4j.FileAppender"&gt;
    &lt;param name="File"   value="A1.log" /&gt;
    &lt;param name="Append" value="false" /&gt;
    &lt;layout class="org.apache.log4j.xml.XMLLayout" /&gt;
  &lt;/appender&gt;
  &lt;appender name="STDOUT" class="org.apache.log4j.ConsoleAppender"&gt;
    &lt;layout class="org.apache.log4j.SimpleLayout" /&gt;
  &lt;/appender&gt;
  &lt;category name="org.apache.log4j.xml"&gt;
    &lt;priority value="debug" /&gt;
    &lt;appender-ref ref="A1" /&gt;
  &lt;/category&gt;
  &lt;root&gt;
    &lt;priority value ="debug" /&gt;
    &lt;appender-ref ref="STDOUT" /&gt;
  &lt;/Root&gt;
&lt;/log4j:configuration&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Log4j 2 XML configuration</p>
</div>
<div class="listingblock">
<div class="title">log4j2.xml</div>
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;Configuration&gt;
  &lt;Appenders&gt;
    &lt;File name="A1" fileName="A1.log" append="false"&gt;
      &lt;Log4j1XmlLayout /&gt;
    &lt;/File&gt;
    &lt;Console name="STDOUT" target="SYSTEM_OUT"&gt;
      &lt;PatternLayout pattern="%level - %m%n"/&gt;
    &lt;/Console&gt;
  &lt;/Appenders&gt;
  &lt;Loggers&gt;
    &lt;Logger name="org.apache.log4j.xml" level="debug"&gt;
      &lt;AppenderRef ref="A1"/&gt;
    &lt;/Logger&gt;
    &lt;Root level="debug"&gt;
      &lt;AppenderRef ref="STDOUT"/&gt;
    &lt;/Root&gt;
  &lt;/Loggers&gt;
&lt;/Configuration&gt;</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="sample_3_socketappender">Sample 3 - SocketAppender</h3>
<div class="paragraph">
<p>Log4j 1.x XML configuration. This example from Log4j 1.x is misleading.
The SocketAppender does not actually use a Layout. Configuring one will
have no effect.</p>
</div>
<div class="listingblock">
<div class="title">log4j.xml</div>
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;!DOCTYPE log4j:configuration PUBLIC "-//APACHE//DTD LOG4J 1.2//EN" "log4j.dtd"&gt;
&lt;log4j:configuration xmlns:log4j="http://jakarta.apache.org/log4j/"&gt;
  &lt;appender name="A1" class="org.apache.log4j.net.SocketAppender"&gt;
    &lt;param name="RemoteHost" value="localhost"/&gt;
    &lt;param name="Port" value="5000"/&gt;
    &lt;param name="LocationInfo" value="true"/&gt;
    &lt;layout class="org.apache.log4j.PatternLayout"&gt;
      &lt;param name="ConversionPattern" value="%t %-5p %c{2} - %m%n"/&gt;
    &lt;/layout&gt;
  &lt;/appender&gt;
  &lt;appender name="STDOUT" class="org.apache.log4j.ConsoleAppender"&gt;
    &lt;layout class="org.apache.log4j.PatternLayout"&gt;
      &lt;param name="ConversionPattern" value="%d %-5p [%t] %C{2} (%F:%L) - %m%n"/&gt;
    &lt;/layout&gt;
  &lt;/appender&gt;
  &lt;category name="org.apache.log4j.xml"&gt;
    &lt;priority value="debug"/&gt;
    &lt;appender-ref ref="A1"/&gt;
  &lt;/category&gt;
  &lt;root&gt;
    &lt;priority value="debug"/&gt;
    &lt;appender-ref ref="STDOUT"/&gt;
  &lt;/Root&gt;
&lt;/log4j:configuration&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Log4j 2 XML configuration</p>
</div>
<div class="listingblock">
<div class="title">log4j2.xml</div>
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;Configuration&gt;
  &lt;Appenders&gt;
    &lt;Socket name="A1" host="localHost" port="5000"&gt;
      &lt;PatternLayout pattern="%t %-5p %c{2} - %m%n"/&gt;
    &lt;/Socket&gt;
    &lt;Console name="STDOUT" target="SYSTEM_OUT"&gt;
      &lt;PatternLayout pattern="%d %-5p [%t] %C{2} (%F:%L) - %m%n"/&gt;
    &lt;/Console&gt;
  &lt;/Appenders&gt;
  &lt;Loggers&gt;
    &lt;Logger name="org.apache.log4j.xml" level="debug"&gt;
      &lt;AppenderRef ref="A1"/&gt;
    &lt;/Logger&gt;
    &lt;Root level="debug"&gt;
      &lt;AppenderRef ref="STDOUT"/&gt;
    &lt;/Root&gt;
  &lt;/Loggers&gt;
&lt;/Configuration&gt;</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="sample_4_asyncappender_and_ttcclayout">Sample 4 - AsyncAppender and TTCCLayout</h3>
<div class="paragraph">
<p>Log4j 1.x XML configuration using the AsyncAppender.</p>
</div>
<div class="listingblock">
<div class="title">log4j.xml</div>
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;!DOCTYPE log4j:configuration PUBLIC "-//APACHE//DTD LOG4J 1.2//EN" "log4j.dtd"&gt;
&lt;log4j:configuration xmlns:log4j="http://jakarta.apache.org/log4j/" configDebug="true"&gt;
  &lt;appender name="ASYNC" class="org.apache.log4j.AsyncAppender"&gt;
    &lt;appender-ref ref="TEMP"/&gt;
  &lt;/appender&gt;
  &lt;appender name="TEMP" class="org.apache.log4j.FileAppender"&gt;
    &lt;param name="File" value="temp"/&gt;
    &lt;layout class="org.apache.log4j.TTCCLayout"&gt;
      &lt;param name="ThreadPrinting" value="true"/&gt;
      &lt;param name="CategoryPrefixing" value="true"/&gt;
      &lt;param name="ContextPrinting" value="true"/&gt;
    &lt;/layout&gt;
  &lt;/appender&gt;
  &lt;root&gt;
    &lt;priority value="debug"/&gt;
    &lt;appender-ref ref="ASYNC"/&gt;
  &lt;/Root&gt;
&lt;/log4j:configuration&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Log4j 2 XML configuration.</p>
</div>
<div class="listingblock">
<div class="title">log4j2.xml</div>
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;Configuration status="debug"&gt;
  &lt;Appenders&gt;
    &lt;File name="TEMP" fileName="temp"&gt;
      &lt;PatternLayout pattern="%r [%t] %p %c %notEmpty{%ndc }- %m%n"/&gt;
    &lt;/File&gt;
    &lt;Async name="ASYNC"&gt;
      &lt;AppenderRef ref="TEMP"/&gt;
    &lt;/Async&gt;
  &lt;/Appenders&gt;
  &lt;Loggers&gt;
    &lt;Root level="debug"&gt;
      &lt;AppenderRef ref="ASYNC"/&gt;
    &lt;/Root&gt;
  &lt;/Loggers&gt;
&lt;/Configuration&gt;</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="sample_5_asyncappender_with_console_and_file">Sample 5 - AsyncAppender with Console and File</h3>
<div class="paragraph">
<p>Log4j 1.x XML configuration using the AsyncAppender.</p>
</div>
<div class="listingblock">
<div class="title">log4j.xml</div>
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;!DOCTYPE log4j:configuration PUBLIC "-//APACHE//DTD LOG4J 1.2//EN" "log4j.dtd"&gt;
&lt;log4j:configuration xmlns:log4j="http://jakarta.apache.org/log4j/" configDebug="true"&gt;
  &lt;appender name="ASYNC" class="org.apache.log4j.AsyncAppender"&gt;
    &lt;appender-ref ref="TEMP"/&gt;
    &lt;appender-ref ref="CONSOLE"/&gt;
  &lt;/appender&gt;
  &lt;appender name="CONSOLE" class="org.apache.log4j.ConsoleAppender"&gt;
    &lt;layout class="org.apache.log4j.PatternLayout"&gt;
      &lt;param name="ConversionPattern" value="%d %-5p [%t] %C{2} (%F:%L) - %m%n"/&gt;
    &lt;/layout&gt;
  &lt;/appender&gt;
  &lt;appender name="TEMP" class="org.apache.log4j.FileAppender"&gt;
    &lt;param name="File" value="temp"/&gt;
    &lt;layout class="org.apache.log4j.PatternLayout"&gt;
      &lt;param name="ConversionPattern" value="%d %-5p [%t] %C{2} (%F:%L) - %m%n"/&gt;
    &lt;/layout&gt;
  &lt;/appender&gt;
  &lt;root&gt;
    &lt;priority value="debug"/&gt;
    &lt;appender-ref ref="ASYNC"/&gt;
  &lt;/Root&gt;
&lt;/log4j:configuration&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Log4j 2 XML configuration. Note that the Async Appender should be
configured after the appenders it references. This will allow it to
shutdown properly.</p>
</div>
<div class="listingblock">
<div class="title">log4j2.xml</div>
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;Configuration status="debug"&gt;
  &lt;Appenders&gt;
    &lt;Console name="CONSOLE" target="SYSTEM_OUT"&gt;
      &lt;PatternLayout pattern="%d %-5p [%t] %C{2} (%F:%L) - %m%n"/&gt;
    &lt;/Console&gt;
    &lt;File name="TEMP" fileName="temp"&gt;
      &lt;PatternLayout pattern="%d %-5p [%t] %C{2} (%F:%L) - %m%n"/&gt;
    &lt;/File&gt;
    &lt;Async name="ASYNC"&gt;
      &lt;AppenderRef ref="TEMP"/&gt;
      &lt;AppenderRef ref="CONSOLE"/&gt;
    &lt;/Async&gt;
  &lt;/Appenders&gt;
  &lt;Loggers&gt;
    &lt;Root level="debug"&gt;
      &lt;AppenderRef ref="ASYNC"/&gt;
    &lt;/Root&gt;
  &lt;/Loggers&gt;
&lt;/Configuration&gt;</code></pre>
</div>
</div>
</div>
</div>
</div>
        </main>
      </div>
    </div>
    <hr/>
    <footer>
      <div class="container-fluid">
        <div class="row-fluid">
<p align="center">Copyright &copy; 1999-2023 <a class="external" href="http://www.apache.org">The Apache Software Foundation</a>. All Rights Reserved.<br>
      Apache Logging, Apache Log4j, Log4j, Apache, the Apache feather logo, and the Apache Logging project logo are trademarks of The Apache Software Foundation.</p>
        </div>
      </div>
    </footer>
  </body>
</html>
